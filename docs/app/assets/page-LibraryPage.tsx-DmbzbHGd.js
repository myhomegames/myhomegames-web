import{r as a,c as De,j as e}from"./react-vendor-jNdKP8wU.js";import{A as Ye,f as Ee,a as Ce}from"./page-IGDBGameDetailPage.tsx-DJIzSB4n.js";import{k as Fe,c as et,f as Pe,l as tt,g as st,A as Be,m as ze,n as Re,C as lt,o as Ge,S as rt,p as Ke,q as He,D as Oe,T as Le,b as at,G as nt,h as _e,e as it}from"./page-CollectionDetail.tsx-DYxPNzRb.js";import{u as Ue,A as ot}from"./page-CollectionsPage.tsx-CqznnysS.js";import{A as Ve,d as ke,b as Se}from"./page-AddGamePage.tsx-CGFUTWrs.js";import{u as te}from"./i18n-vendor-mPXi0JFR.js";function ct(s={}){const{localStoragePrefix:t="",defaultFilterField:l="all",waitForAuth:u=!1,onInit:c,listenToMetadataReload:g=!1,listenToGameDeleted:p=!1,gameEvents:v=["gameUpdated"],categoryId:m=null,onCategoryIdChange:d,scrollRestorationMode:n}=s,[S,L]=a.useState([]),[j,I]=a.useState(!1),[M,i]=a.useState(()=>t&&localStorage.getItem(`${t}FilterField`)||l),[f,h]=a.useState(()=>{if(t){const x=localStorage.getItem(`${t}SelectedYear`);return x?parseInt(x,10):null}return null}),[y,N]=a.useState(()=>{if(t){const x=localStorage.getItem(`${t}SelectedDecade`);return x?parseInt(x,10):null}return null}),[E,R]=a.useState(()=>{if(t){const x=localStorage.getItem(`${t}SelectedAgeRating`);return x!==null?x:null}return null}),[$,H]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedCollection`)||null),[k,D]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedGenre`)||null),[P,V]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedThemes`)||null),[z,G]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedKeywords`)||null),[Y,ce]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedPlatforms`)||null),[O,K]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedGameModes`)||null),[b,ne]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedPublishers`)||null),[r,_]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedDevelopers`)||null),[W,U]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedPlayerPerspectives`)||null),[C,q]=a.useState(()=>t&&localStorage.getItem(`${t}SelectedGameEngines`)||null),{categories:oe}=Fe(),se=a.useMemo(()=>oe.map(x=>({id:String(x.id),title:x.title})),[oe]),{collections:ue,collectionGameIds:le}=et(),{games:re,isLoading:J}=Ue(),Z=a.useMemo(()=>ue.map(x=>({id:String(x.id),title:x.title||""})),[ue]),[F,me]=a.useState([]),[ie,pe]=a.useState(()=>t&&localStorage.getItem(`${t}SortField`)||"title"),[ae,Q]=a.useState(()=>{if(t){const x=localStorage.getItem(`${t}SortAscending`);return x?x==="true":!0}return!0}),X=a.useRef(null),o=a.useRef(null),T=a.useRef(new Map),[be,ye]=a.useState(()=>{const x=localStorage.getItem("tableColumnVisibility");if(x)try{return JSON.parse(x)}catch{return{title:!0,releaseDate:!0,year:!1,stars:!1,criticRating:!1,ageRating:!1}}return{title:!0,releaseDate:!0,criticRating:!1,ageRating:!1}}),de=(x,w)=>!w||!x||x.length===0?!1:x.some(A=>String(A)===w);a.useEffect(()=>{localStorage.setItem("tableColumnVisibility",JSON.stringify(be))},[be]),a.useEffect(()=>{t&&localStorage.setItem(`${t}FilterField`,M)},[M,t]),a.useEffect(()=>{t&&f!==null?localStorage.setItem(`${t}SelectedYear`,f.toString()):t&&localStorage.removeItem(`${t}SelectedYear`)},[f,t]),a.useEffect(()=>{t&&k!==null?localStorage.setItem(`${t}SelectedGenre`,k):t&&localStorage.removeItem(`${t}SelectedGenre`)},[k,t]),a.useEffect(()=>{t&&P!==null?localStorage.setItem(`${t}SelectedThemes`,P):t&&localStorage.removeItem(`${t}SelectedThemes`)},[P,t]),a.useEffect(()=>{t&&z!==null?localStorage.setItem(`${t}SelectedKeywords`,z):t&&localStorage.removeItem(`${t}SelectedKeywords`)},[z,t]),a.useEffect(()=>{t&&Y!==null?localStorage.setItem(`${t}SelectedPlatforms`,Y):t&&localStorage.removeItem(`${t}SelectedPlatforms`)},[Y,t]),a.useEffect(()=>{t&&O!==null?localStorage.setItem(`${t}SelectedGameModes`,O):t&&localStorage.removeItem(`${t}SelectedGameModes`)},[O,t]),a.useEffect(()=>{t&&b!==null?localStorage.setItem(`${t}SelectedPublishers`,b):t&&localStorage.removeItem(`${t}SelectedPublishers`)},[b,t]),a.useEffect(()=>{t&&r!==null?localStorage.setItem(`${t}SelectedDevelopers`,r):t&&localStorage.removeItem(`${t}SelectedDevelopers`)},[r,t]),a.useEffect(()=>{t&&W!==null?localStorage.setItem(`${t}SelectedPlayerPerspectives`,W):t&&localStorage.removeItem(`${t}SelectedPlayerPerspectives`)},[W,t]),a.useEffect(()=>{t&&C!==null?localStorage.setItem(`${t}SelectedGameEngines`,C):t&&localStorage.removeItem(`${t}SelectedGameEngines`)},[C,t]),a.useEffect(()=>{t&&y!==null?localStorage.setItem(`${t}SelectedDecade`,y.toString()):t&&localStorage.removeItem(`${t}SelectedDecade`)},[y,t]),a.useEffect(()=>{t&&$!==null?localStorage.setItem(`${t}SelectedCollection`,$):t&&localStorage.removeItem(`${t}SelectedCollection`)},[$,t]),a.useEffect(()=>{t&&E!==null?localStorage.setItem(`${t}SelectedAgeRating`,E):t&&localStorage.removeItem(`${t}SelectedAgeRating`)},[E,t]),a.useEffect(()=>{t&&localStorage.setItem(`${t}SortField`,ie)},[ie,t]),a.useEffect(()=>{t&&localStorage.setItem(`${t}SortAscending`,ae.toString())},[ae,t]),Pe(n===void 0?X:n==="table"?o:X,n),a.useEffect(()=>{u||c&&c()},[]),a.useEffect(()=>{if(!g)return;const x=()=>{};return window.addEventListener("metadataReloaded",x),()=>{window.removeEventListener("metadataReloaded",x)}},[g]),a.useEffect(()=>{if(!p)return;const x=w=>{const B=w.detail?.gameId;B&&L(fe=>fe.filter(Te=>String(Te.id)!==String(B)))};return window.addEventListener("gameDeleted",x),()=>{window.removeEventListener("gameDeleted",x)}},[p]),tt({setGames:L,enabledEvents:v});const Ne=a.useMemo(()=>{let x=[...S];return M!=="all"&&(x=x.filter(w=>{switch(M){case"genre":return k!==null?Array.isArray(w.genre)?w.genre.some(A=>(typeof A=="string"?A:String(A))===k):typeof w.genre=="string"?w.genre===k:!1:!0;case"themes":return P===null?!0:de(w.themes||null,P);case"keywords":return z===null?!0:de(w.keywords||null,z);case"platforms":return Y===null?!0:de(w.platforms||null,Y);case"gameModes":return O===null?!0:de(w.gameModes||null,O);case"publishers":return b===null?!0:de(w.publishers||null,b);case"developers":return r===null?!0:de(w.developers||null,r);case"playerPerspectives":return W===null?!0:de(w.playerPerspectives||null,W);case"gameEngines":return C===null?!0:de(w.gameEngines||null,C);case"year":return f!==null?w.year===f:w.year!==null&&w.year!==void 0;case"decade":return y!==null&&w.year!==null&&w.year!==void 0?Math.floor(w.year/10)*10===y:!1;case"collection":if($!==null){const A=le.get(String($));if(!A)return!1;const B=String(w.id);return A.some(fe=>String(fe)===B)}return!1;case"ageRating":if(E!==null){const[A,B]=E.split("-").map(Number);return w.ageRatings&&w.ageRatings.length>0?w.ageRatings.some(fe=>fe.category===A&&fe.rating===B):!1}return!1;default:return!0}})),x.sort((w,A)=>{let B=0;switch(ie){case"title":B=st(w.title||"",A.title||"");break;case"year":const fe=w.year??0;B=(A.year??0)-fe;break;case"stars":const Ze=w.stars??0;B=(A.stars??0)-Ze;break;case"releaseDate":const $e=w.year??0,Ie=A.year??0;if($e!==Ie)B=Ie-$e;else{const he=w.month??0,ve=A.month??0;if(he!==ve)B=ve-he;else{const Xe=w.day??0;B=(A.day??0)-Xe}}break;case"criticRating":const Je=w.criticratings??0;B=(A.criticratings??0)-Je;break;case"userRating":const Qe=w.userratings??0;B=(A.userratings??0)-Qe;break;case"ageRating":const je=w.ageRatings&&w.ageRatings.length>0?w.ageRatings:[],we=A.ageRatings&&A.ageRatings.length>0?A.ageRatings:[];if(je.length===0&&we.length===0)B=0;else if(je.length===0)B=1;else if(we.length===0)B=-1;else{const he=je[0],ve=we[0];he.category!==ve.category?B=he.category-ve.category:B=ve.rating-he.rating}break;default:B=0}return ae?B:-B}),x},[S,M,k,P,z,Y,O,b,r,W,C,f,y,$,E,le,ie,ae]);return a.useLayoutEffect(()=>{J?J&&I(!1):requestAnimationFrame(()=>{requestAnimationFrame(()=>{I(!0)})})},[J,Ne.length]),a.useEffect(()=>{if(m&&se.length>0){const x=se.find(w=>String(w.id)===m);x&&(D(x.title),i("genre")),d&&d(m)}},[m,se,d]),a.useEffect(()=>{re.length>0&&L(re)},[re]),a.useEffect(()=>{if(S.length===0||se.length===0)return;const x=new Set;S.forEach(A=>{A.genre&&(Array.isArray(A.genre)?A.genre.forEach(B=>{typeof B=="string"?x.add(B):x.add(String(B))}):typeof A.genre=="string"&&x.add(A.genre))});const w=se.filter(A=>x.has(A.title));me(w),k!==null&&M==="genre"&&(w.some(B=>B.title===k)||(D(null),i("all")))},[S,se,k,M]),{games:S,setGames:L,isReady:j,filterField:M,setFilterField:i,selectedYear:f,setSelectedYear:h,selectedDecade:y,setSelectedDecade:N,selectedCollection:$,setSelectedCollection:H,selectedAgeRating:E,setSelectedAgeRating:R,selectedGenre:k,setSelectedGenre:D,selectedThemes:P,setSelectedThemes:V,selectedKeywords:z,setSelectedKeywords:G,selectedPlatforms:Y,setSelectedPlatforms:ce,selectedGameModes:O,setSelectedGameModes:K,selectedPublishers:b,setSelectedPublishers:ne,selectedDevelopers:r,setSelectedDevelopers:_,selectedPlayerPerspectives:W,setSelectedPlayerPerspectives:U,selectedGameEngines:C,setSelectedGameEngines:q,allGenres:se,availableGenres:F,availableCollections:Z,sortField:ie,setSortField:pe,sortAscending:ae,setSortAscending:Q,columnVisibility:be,setColumnVisibility:ye,filteredAndSortedGames:Ne,scrollContainerRef:X,tableScrollRef:o,itemRefs:T,handleTableSort:x=>{ie===x?Q(!ae):(pe(x),Q(!0))},toggleColumn:x=>{ye(w=>({...w,[x]:!w[x]}))},handleGameUpdate:x=>{L(w=>w.map(A=>String(A.id)===String(x.id)?x:A)),window.dispatchEvent(new CustomEvent("gameUpdated",{detail:{game:x}}))},handleGameDelete:x=>{L(w=>w.filter(A=>A.id!==x.id))}}}function ut(s){try{const t=sessionStorage.getItem(s);return t?parseFloat(t):null}catch{return null}}function Me(s,t){try{sessionStorage.setItem(s,t.toString())}catch{}}const dt=144,ft=3;function gt({games:s,containerRef:t,itemRefs:l,onGameClick:u,onPlay:c,onEditClick:g,onGameDelete:p,onGameUpdate:v,buildCoverUrl:m,allCollections:d=[]}){const n=De(),[S,L]=a.useState({width:0,height:0}),j=a.useRef(null),I=a.useRef(!1),M=`${n.pathname}:detail`;a.useEffect(()=>{t&&"current"in t&&t.current&&(t.current.__virtualizedListRef=j)},[t]),a.useEffect(()=>{const f=()=>{if(t.current){const y=t.current.getBoundingClientRect();L({width:y.width-40,height:y.height||window.innerHeight-200})}};f(),window.addEventListener("resize",f);const h=new ResizeObserver(f);return t.current&&h.observe(t.current),()=>{window.removeEventListener("resize",f),h.disconnect()}},[t]),a.useEffect(()=>{if(S.height===0||s.length===0)return;const f=ut(M);if(f===null||f<0)return;I.current=!0;const h=(N=0)=>{const E=j.current;if(!E){N<50?setTimeout(()=>h(N+1),50):I.current=!1;return}let R=null;if(E.element)R=E.element;else if(t.current){const $=t.current.querySelector('[style*="overflow"]');$&&$.scrollHeight>$.clientHeight&&(R=$)}if(!R){N<50?setTimeout(()=>h(N+1),50):I.current=!1;return}try{R.scrollTop=f,setTimeout(()=>{const $=R.scrollTop;Math.abs($-f)>10&&N<5&&(R.scrollTop=f),setTimeout(()=>{I.current=!1},200)},100)}catch{N<10?setTimeout(()=>h(N+1),100):I.current=!1}},y=setTimeout(()=>{h()},300);return()=>{clearTimeout(y),I.current=!1}},[n.pathname,M,S.height,s.length]),a.useEffect(()=>{let f=null,h=null;const y=(N=0)=>{const E=j.current;if(!E){N<20&&setTimeout(()=>y(N+1),100);return}let R=null;if(E.element)R=E.element;else if(t.current){const H=t.current.querySelector('[style*="overflow"]');H&&H.scrollHeight>H.clientHeight&&(R=H)}if(!R){N<20&&setTimeout(()=>y(N+1),100);return}const $=()=>{I.current||(f&&clearTimeout(f),f=setTimeout(()=>{const H=R.scrollTop;Me(M,H)},150))};R.addEventListener("scroll",$,{passive:!0}),h=()=>{if(f&&clearTimeout(f),R.removeEventListener("scroll",$),!I.current&&R){const H=R.scrollTop;Me(M,H)}}};return y(),()=>{h&&h()}},[j.current,M,s.length]);const i=({index:f,style:h})=>{const y=s[f];return e.jsx("div",{style:h,children:e.jsx(We,{game:y,onGameClick:u,onPlay:c,onEditClick:g,onGameDelete:p,onGameUpdate:v,buildCoverUrl:m,itemRefs:l,index:f,allCollections:d})})};return S.width===0||S.height===0?e.jsx("div",{style:{width:"100%",height:"100%"}}):e.jsx(Be,{listRef:j,className:"virtualized-games-list-detail",defaultHeight:S.height,rowCount:s.length,rowHeight:dt,overscanCount:ft,rowComponent:i,rowProps:{},style:{height:S.height,width:S.width},onResize:f=>{L({width:f.width,height:f.height})}})}const mt=100,Ae=100;function We({game:s,onGameClick:t,onPlay:l,onEditClick:u,onGameDelete:c,onGameUpdate:g,buildCoverUrl:p,itemRefs:v,index:m,allCollections:d=[]}){const{t:n,i18n:S}=te(),L=m%2===0,j=Ae*1.5,I=a.useRef(s.cover),M=I.current!==s.cover;M&&(I.current=s.cover);const i=a.useMemo(()=>p(Ve,s.cover,M),[s.cover,M,p]),f=h=>{h.stopPropagation(),u(s)};return e.jsxs("div",{ref:h=>{h&&v?.current&&v.current.set(s.id,h)},className:`group cursor-pointer mb-6 games-list-detail-item ${L?"even":"odd"}`,onClick:()=>t(s),children:[e.jsx(lt,{title:s.title,coverUrl:i,width:Ae,height:j,onPlay:l?()=>l(s):void 0,showTitle:!1,detail:!1,play:!!(s.executables&&s.executables.length>0),showBorder:!1},`${s.id}-${s.cover}`),e.jsxs("div",{className:"games-list-detail-content",children:[e.jsx("div",{className:"text-white mb-2 games-list-detail-title",children:s.title}),s.year!==null&&s.year!==void 0||s.stars!==null&&s.stars!==void 0?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap"},children:[s.year!==null&&s.year!==void 0&&e.jsx("div",{className:"text-gray-500",style:{fontSize:"0.85rem"},children:ke(s,n,S)||s.year.toString()}),s.stars!==null&&s.stars!==void 0&&e.jsx(Ge,{rating:s.stars/10*5,starSize:14,gap:3})]}):null,s.summary&&e.jsx(rt,{summary:s.summary,truncateOnly:!0,maxLines:2,fontSize:"0.85rem"})]}),e.jsxs("div",{className:"games-list-detail-actions",children:[e.jsx("button",{onClick:f,className:"games-list-detail-edit-button","aria-label":"Edit",children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),e.jsx(Ke,{game:s,allCollections:d}),s.executables&&s.executables.length>1&&l&&e.jsx(He,{gameId:s.id,gameExecutables:s.executables,onPlayExecutable:h=>{l&&l(s,h)}}),e.jsx(Oe,{gameId:s.id,gameTitle:s.title,gameExecutables:s.executables,onAddToCollection:()=>{},onGameDelete:c?h=>{s.id===h&&c(s)}:void 0,onGameUpdate:g?h=>{h.id===s.id&&g(h)}:void 0,className:"games-list-detail-dropdown-menu"})]})]})}function pt({games:s,onGameClick:t,onPlay:l,onGameUpdate:u,onGameDelete:c,buildCoverUrl:g,itemRefs:p,allCollections:v=[],scrollContainerRef:m}){const{t:d}=te(),n=ze();if(s.length===0)return e.jsx("div",{className:"centered-content h-full min-h-[400px]",children:e.jsx("div",{className:"text-gray-400 text-center",children:d("table.noGames")})});const S=I=>{u&&u(I),n.closeEditModal()},L=s.length>mt,j=a.useRef(null);return e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:j,className:"games-list-detail-container",style:{height:L?"100%":void 0},children:L?e.jsx(gt,{games:s,containerRef:m||j,itemRefs:p,onGameClick:t,onPlay:l,onEditClick:n.openEditModal,onGameDelete:c,onGameUpdate:u,buildCoverUrl:g,allCollections:v}):s.map((I,M)=>e.jsx(We,{game:I,onGameClick:t,onPlay:l,onEditClick:n.openEditModal,onGameDelete:c,onGameUpdate:u,buildCoverUrl:g,itemRefs:p,index:M,allCollections:v},I.id))}),n.selectedGame&&e.jsx(Re,{isOpen:n.isEditModalOpen,onClose:n.closeEditModal,game:n.selectedGame,onGameUpdate:S})]})}function qe({game:s,index:t,itemRefs:l,onGameClick:u,onPlay:c,onGameUpdate:g,onGameDelete:p,allCollections:v=[],columnVisibility:m,handleRatingChange:d,formatRating:n,formatGameDate:S,t:L,i18n:j,editGame:I}){const i=t%2===0?"even-row":"odd-row",f=m.title?"title":m.releaseDate?"releaseDate":m.stars?"stars":m.year?"year":m.criticRating?"criticRating":m.ageRating?"ageRating":null,h=()=>{if(!s.executables||s.executables.length===0)return null;const y=N=>{N.stopPropagation(),c&&c(s)};return e.jsx("button",{className:"first-cell-play-button","aria-label":"Play game",onClick:y,children:e.jsx("svg",{width:"36",height:"36",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M8 5v14l11-7z",fill:"currentColor"})})})};return e.jsxs("tr",{ref:y=>{y&&l?.current&&l.current.set(s.id,y)},children:[e.jsx("td",{className:"column-menu-cell"}),m.title&&e.jsxs("td",{className:`title-cell ${i} ${f==="title"?"first-visible-cell":""}`,children:[f==="title"&&c&&e.jsx(h,{}),e.jsx(Le,{text:s.title,delay:1e3,children:e.jsx("span",{className:f==="title"?"first-cell-text":"title-cell-text",onClick:()=>u(s),children:s.title})})]}),m.releaseDate&&e.jsxs("td",{className:`date-cell ${i} ${m.stars||m.year||m.criticRating?"has-border-right":""} ${f==="releaseDate"?"first-visible-cell":""}`,children:[f==="releaseDate"&&c&&e.jsx(h,{}),e.jsx("span",{className:f==="releaseDate"?"first-cell-text":"",children:S(s,L,j)||"-"})]}),m.stars&&e.jsxs("td",{className:`stars-cell ${i} ${f==="stars"?"first-visible-cell":""}`,children:[f==="stars"&&c&&e.jsx(h,{}),e.jsx("div",{className:f==="stars"?"first-cell-text":"",style:{display:"flex",alignItems:"center"},children:e.jsx(Ge,{rating:s.stars?s.stars/10*5:0,starSize:14,gap:3,color:"rgba(255, 255, 255, 0.4)",noStroke:!0,readOnly:!Se,onRatingChange:Se?y=>d(s.id,y):void 0})})]}),m.year&&e.jsxs("td",{className:`year-cell ${i} has-border-right ${f==="year"?"first-visible-cell":""}`,children:[f==="year"&&c&&e.jsx(h,{}),e.jsx("span",{className:f==="year"?"first-cell-text":"",children:s.year||"-"})]}),m.criticRating&&e.jsxs("td",{className:`critic-rating-cell ${i} has-border-right ${f==="criticRating"?"first-visible-cell":""}`,children:[f==="criticRating"&&c&&e.jsx(h,{}),e.jsx("div",{className:f==="criticRating"?"first-cell-text":"",style:{display:"flex",alignItems:"center",gap:"12px",flexWrap:"wrap"},children:(()=>{const y=n(s.criticratings),N=n(s.userratings);return y===null&&N===null?e.jsx("span",{children:"-"}):e.jsxs(e.Fragment,{children:[y!==null&&e.jsx(Le,{text:L("gameDetail.criticRating"),children:e.jsxs("div",{className:"text-white",style:{opacity:.8,fontFamily:"var(--font-body-2-font-family)",fontSize:"var(--font-body-2-font-size)",lineHeight:"var(--font-body-2-line-height)",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"#FFD700",stroke:"#FFA500",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{flexShrink:0},children:e.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"})}),y]})}),N!==null&&e.jsx(Le,{text:L("gameDetail.userRating"),children:e.jsxs("div",{className:"text-white",style:{opacity:.8,fontFamily:"var(--font-body-2-font-family)",fontSize:"var(--font-body-2-font-size)",lineHeight:"var(--font-body-2-line-height)",display:"flex",alignItems:"center",gap:"8px"},children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"#4CAF50",stroke:"#2E7D32",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",style:{flexShrink:0},children:[e.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),N]})})]})})()})]}),m.ageRating&&e.jsxs("td",{className:`age-rating-cell ${i} has-border-right ${f==="ageRating"?"first-visible-cell":""}`,children:[f==="ageRating"&&c&&e.jsx(h,{}),e.jsx("div",{className:f==="ageRating"?"first-cell-text":"",children:s.ageRatings&&s.ageRatings.length>0?e.jsx(Ye,{ageRatings:s.ageRatings}):e.jsx("span",{children:"-"})})]}),e.jsx("td",{className:`games-table-edit-cell ${i}`,children:e.jsxs("div",{className:"games-table-actions",children:[e.jsx("button",{onClick:y=>{y.stopPropagation(),I.openEditModal(s)},className:"games-table-edit-button","aria-label":"Edit",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}),e.jsx(Ke,{game:s,allCollections:v}),s.executables&&s.executables.length>1&&c&&e.jsx(He,{gameId:s.id,gameExecutables:s.executables,onPlayExecutable:y=>{c&&c(s,y)}}),e.jsx(Oe,{gameId:s.id,gameTitle:s.title,gameExecutables:s.executables,onAddToCollection:()=>{},onGameDelete:p?y=>{const N=s.id===y?s:null;N&&p(N)}:void 0,onGameUpdate:g?y=>{y.id===s.id&&g(y)}:void 0,className:"games-table-dropdown-menu"})]})})]},s.id)}function ht(s){try{const t=sessionStorage.getItem(s);return t?parseFloat(t):null}catch{return null}}function vt(s,t){try{sessionStorage.setItem(s,t.toString())}catch{}}const xt=56,bt=5;function yt({games:s,containerRef:t,itemRefs:l,onGameClick:u,onPlay:c,onGameUpdate:g,onGameDelete:p,allCollections:v=[],columnVisibility:m,handleRatingChange:d,formatRating:n,formatGameDate:S,t:L,i18n:j,editGame:I}){const M=De(),[i,f]=a.useState({width:0,height:0}),h=a.useRef(null),y=a.useRef(!1),N=a.useRef(null),E=`${M.pathname}:table`,[R,$]=a.useState(!1);a.useEffect(()=>{t&&"current"in t&&t.current&&(t.current.__virtualizedListRef=h)},[t]),a.useEffect(()=>{const k=()=>{if(t.current){const P=t.current.getBoundingClientRect();f({width:P.width-40,height:P.height||window.innerHeight-200})}};k(),window.addEventListener("resize",k);const D=new ResizeObserver(k);return t.current&&D.observe(t.current),()=>{window.removeEventListener("resize",k),D.disconnect()}},[t]),a.useEffect(()=>{if(i.height===0||s.length===0)return;const k=ht(E);if(k===null||k<0){$(!0);return}y.current=!0;const D=(P=0)=>{const V=h.current;if(!V){P<50?setTimeout(()=>D(P+1),50):(y.current=!1,$(!0));return}let z=null;if(V.element)z=V.element;else if(t.current){const G=t.current.querySelector('[style*="overflow"]');G&&G.scrollHeight>G.clientHeight&&(z=G)}if(!z){P<20?setTimeout(()=>D(P+1),50):(y.current=!1,$(!0));return}z.scrollTop=k,setTimeout(()=>{y.current=!1,$(!0)},50)};D()},[i.height,s.length,E,t]),a.useEffect(()=>{if(y.current||i.height===0)return;const k=h.current;if(!k)return;let D=null;if(k.element?D=k.element:t.current&&(D=t.current.querySelector('[style*="overflow"]')),!D)return;const P=()=>{if(y.current)return;const z=D?.scrollTop||0;N.current!==null&&Math.abs(N.current-z)<10||(N.current=z,vt(E,z))};let V;return D.addEventListener("scroll",()=>{clearTimeout(V),V=window.setTimeout(P,100)},{passive:!0}),()=>{clearTimeout(V),D?.removeEventListener("scroll",P)}},[i.height,E,t]);const H=({index:k,style:D})=>{const P=s[k];return P?e.jsx("div",{style:D,className:"virtualized-table-row-wrapper",children:e.jsx(qe,{game:P,index:k,itemRefs:l,onGameClick:u,onPlay:c,onGameUpdate:g,onGameDelete:p,allCollections:v,columnVisibility:m,handleRatingChange:d,formatRating:n,formatGameDate:S,t:L,i18n:j,editGame:I})}):null};return i.height===0||s.length===0?e.jsx("div",{style:{width:"100%",height:"100%"}}):e.jsx("div",{style:{opacity:R?1:0,transition:R?"opacity 0.1s":"none"},children:e.jsx("div",{className:"virtualized-games-table-wrapper",children:e.jsx("table",{className:"games-table",children:e.jsx("tbody",{className:"virtualized-games-table-tbody",children:e.jsx(Be,{listRef:h,className:"virtualized-games-table-list",defaultHeight:i.height,rowCount:s.length,rowHeight:xt,overscanCount:bt,rowComponent:H,rowProps:{},style:{height:i.height,width:i.width},onResize:k=>{f({width:k.width,height:k.height})}})})})})})}const St=100;function jt({games:s,onGameClick:t,onPlay:l,onGameUpdate:u,onGameDelete:c,itemRefs:g,scrollContainerRef:p,allCollections:v=[],columnVisibility:m}){const d=a.useRef(null),n=p||d;Pe(n,"table");const[S,L]=a.useState(s),j=ze();a.useEffect(()=>{L(s)},[s]);const I=async(E,R)=>{if(Se)try{const $=at(Ve,`/games/${E}`);if((await fetch($,{method:"PUT",headers:{"Content-Type":"application/json","X-Auth-Token":Se},body:JSON.stringify({stars:R})})).ok){const k=S.map(D=>D.id===E?{...D,stars:R}:D);L(k)}else console.error("Failed to update rating")}catch($){console.error("Error updating rating:",$)}},M=E=>{const R=S.map($=>$.id===E.id?E:$);L(R),u&&u(E),j.closeEditModal()},{t:i,i18n:f}=te();if(s.length===0)return e.jsx("div",{className:"centered-content h-full min-h-[400px]",children:e.jsx("div",{className:"text-gray-400 text-center",children:i("table.noGames")})});const h=E=>{if(E==null||isNaN(E))return null;const R=Number(E);return R<0||R>10?null:R%1===0?R.toString():R.toFixed(1)},y=S.length>St,N=a.useRef(null);return y?e.jsxs("div",{className:"games-table-container",children:[e.jsx("div",{className:"games-table-scroll virtualized-table-scroll",ref:N,children:e.jsx(yt,{games:S,containerRef:N,itemRefs:g,onGameClick:t,onPlay:l,onGameUpdate:u,onGameDelete:c,allCollections:v,columnVisibility:m,handleRatingChange:I,formatRating:h,formatGameDate:ke,t:i,i18n:f,editGame:j})}),j.selectedGame&&e.jsx(Re,{isOpen:j.isEditModalOpen,onClose:j.closeEditModal,game:j.selectedGame,onGameUpdate:M})]}):e.jsxs("div",{className:"games-table-container",children:[e.jsx("div",{className:"games-table-scroll",ref:n,children:e.jsx("table",{className:"games-table",children:e.jsx("tbody",{children:S.map((E,R)=>e.jsx(qe,{game:E,index:R,itemRefs:g,onGameClick:t,onPlay:l,onGameUpdate:u,onGameDelete:c,allCollections:v,columnVisibility:m,handleRatingChange:I,formatRating:h,formatGameDate:ke,t:i,i18n:f,editGame:j},E.id))})})}),j.selectedGame&&e.jsx(Re,{isOpen:j.isEditModalOpen,onClose:j.closeEditModal,game:j.selectedGame,onGameUpdate:M})]})}function wt({columnVisibility:s,onToggleColumn:t,sortField:l,sortAscending:u=!0,onSort:c}){const{t:g,i18n:p}=te(),[v,m]=a.useState(!1),d=a.useRef(null);a.useEffect(()=>{function j(I){d.current&&!d.current.contains(I.target)&&m(!1)}return document.addEventListener("mousedown",j),()=>{document.removeEventListener("mousedown",j)}},[]);const n=j=>l!==j?"":u?"↑":"↓",S=a.useMemo(()=>[{key:"title",label:g("table.title")},{key:"releaseDate",label:g("table.releaseDate")},{key:"year",label:g("table.year")},{key:"stars",label:g("table.stars")},{key:"criticRating",label:g("table.criticRating")},{key:"ageRating",label:g("table.ageRating")}],[g,p.language]),L=s.title?"title":s.releaseDate?"releaseDate":s.stars?"stars":s.year?"year":s.criticRating?"criticRating":s.ageRating?"ageRating":null;return e.jsx("div",{className:"games-table-header-section",children:e.jsx("table",{className:"games-table-header-table",children:e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"games-table-header-table th column-menu",children:e.jsxs("div",{className:"games-table-column-menu-wrapper",ref:d,children:[e.jsxs("button",{onClick:()=>m(!v),className:"games-table-column-menu-button",children:[e.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),e.jsx("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:1.5,className:`games-table-column-menu-arrow ${v?"open":""}`,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})})]}),v&&e.jsx("div",{className:"games-table-column-menu-popup",children:S.map(j=>e.jsxs("button",{className:`games-table-column-menu-item ${s[j.key]?"selected":""}`,onClick:()=>t(j.key),children:[e.jsx("span",{children:j.label}),s[j.key]&&e.jsx("svg",{className:"games-table-column-menu-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]},j.key))})]})}),s.title&&e.jsxs("th",{onClick:()=>c("title"),className:`title-cell has-border-right ${L==="title"?"first-visible-cell":""} ${l==="title"?"sorted":""}`,children:[e.jsx("span",{children:g("table.title")}),e.jsx("span",{className:"sort-indicator",children:n("title")})]}),s.releaseDate&&e.jsxs("th",{onClick:()=>c("releaseDate"),className:`date-cell has-border-right ${L==="releaseDate"?"first-visible-cell":""} ${l==="releaseDate"?"sorted":""}`,children:[e.jsx("span",{children:g("table.releaseDate")}),e.jsx("span",{className:"sort-indicator",children:n("releaseDate")})]}),s.stars&&e.jsxs("th",{onClick:()=>c("stars"),className:`stars-cell has-border-right ${L==="stars"?"first-visible-cell":""} ${l==="stars"?"sorted":""}`,children:[e.jsx("span",{children:g("table.stars")}),e.jsx("span",{className:"sort-indicator",children:n("stars")})]}),s.year&&e.jsxs("th",{onClick:()=>c("year"),className:`year-cell has-border-right ${L==="year"?"first-visible-cell":""} ${l==="year"?"sorted":""}`,children:[e.jsx("span",{children:g("table.year")}),e.jsx("span",{className:"sort-indicator",children:n("year")})]}),s.criticRating&&e.jsxs("th",{onClick:()=>c("criticRating"),className:`critic-rating-cell has-border-right ${L==="criticRating"?"first-visible-cell":""} ${l==="criticRating"?"sorted":""}`,children:[e.jsx("span",{children:g("table.criticRating")}),e.jsx("span",{className:"sort-indicator",children:n("criticRating")})]}),s.ageRating&&e.jsxs("th",{onClick:()=>c("ageRating"),className:`age-rating-cell has-border-right ${L==="ageRating"?"first-visible-cell":""} ${l==="ageRating"?"sorted":""}`,children:[e.jsx("span",{children:g("table.ageRating")}),e.jsx("span",{className:"sort-indicator",children:n("ageRating")})]}),e.jsx("th",{className:"games-table-edit-header"})]})})})})}function xe({isOpen:s,onClose:t,onCloseCompletely:l,selectedValue:u,onSelect:c,games:g=[],config:p,additionalData:v}){const{t:m}=te(),[d,n]=a.useState(""),S=a.useRef(null),L=a.useMemo(()=>p.getAvailableValues(g,v),[g,p,v]),j=a.useMemo(()=>{if(!d)return L;const i=d.toLowerCase();return L.filter(f=>f.label.toLowerCase().includes(i)||f.value?.toString().toLowerCase().includes(i))},[L,d]);a.useEffect(()=>{if(!s)return;function i(f){S.current&&!S.current.contains(f.target)&&l()}return document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}},[s,l]),a.useEffect(()=>{if(!s)return;function i(f){f.key==="Escape"&&l()}return document.addEventListener("keydown",i),()=>{document.removeEventListener("keydown",i)}},[s,l]),a.useEffect(()=>{s&&n("")},[s]);const I=()=>{t()},M=i=>{c(i)};return s?e.jsxs("div",{className:"filter-popup",ref:S,children:[e.jsxs("div",{className:"filter-popup-header",children:[e.jsx("button",{className:"filter-popup-back",onClick:I,children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("span",{className:"filter-popup-header-title",children:m(p.labelKey)})]}),e.jsx("div",{className:"filter-popup-search",children:e.jsx("input",{id:`filter-search-${p.type}`,name:"filterSearch",type:"text",className:"filter-popup-search-input",placeholder:m(p.searchPlaceholderKey),value:d,onChange:i=>n(i.target.value),onClick:i=>i.stopPropagation(),"aria-label":m(p.searchPlaceholderKey)})}),e.jsx("div",{className:`filter-popup-content ${p.isScrollable?"filter-popup-scrollable":""}`,children:j.map(i=>e.jsx("button",{className:`filter-popup-item ${u===i.value?"active":""}`,onClick:()=>M(i.value),children:i.label},i.value?.toString()||"null"))})]}):null}const Lt={type:"year",labelKey:"gamesListToolbar.filter.year",searchPlaceholderKey:"gamesListToolbar.filter.searchYear",getAvailableValues:s=>{const t=new Set;return s.forEach(l=>{l.year!==null&&l.year!==void 0&&t.add(l.year)}),Array.from(t).sort((l,u)=>u-l).map(l=>({value:l,label:l.toString()}))},formatValue:s=>typeof s=="number"?s.toString():"",isScrollable:!1};function Et(s){return e.jsx(xe,{...s,config:Lt})}function Rt({availableGenres:s=[],...t}){const{t:l}=te(),u=a.useMemo(()=>({type:"genre",labelKey:"gamesListToolbar.filter.genre",searchPlaceholderKey:"gamesListToolbar.filter.searchGenre",getAvailableValues:(g,p)=>(p?.availableGenres||s).map(m=>({value:m.title,label:l(`genre.${m.title}`,m.title)})),formatValue:g=>{if(typeof g!="string")return"";const p=s.find(v=>v.title===g);return p?l(`genre.${p.title}`,p.title):""},isScrollable:!0}),[s,l]),c=a.useMemo(()=>({availableGenres:s}),[s]);return e.jsx(xe,{...t,config:u,additionalData:c})}function ge({type:s,labelKey:t,searchPlaceholderKey:l,valueExtractor:u,formatValue:c,...g}){const p=a.useMemo(()=>({type:s,labelKey:t,searchPlaceholderKey:l,getAvailableValues:v=>{const m=new Set;return v.forEach(n=>{(u(n)||[]).forEach(L=>{if(typeof L=="string"){const j=L.trim();j&&m.add(j)}})}),Array.from(m).sort((n,S)=>(c?c(n):n).localeCompare(c?c(S):S)).map(n=>({value:n,label:c?c(n):n}))},formatValue:v=>typeof v!="string"?"":c?c(v):v,isScrollable:!0}),[c,t,l,s,u]);return e.jsx(xe,{...g,config:p})}function kt(s){const{t}=te(),l=a.useMemo(()=>u=>t(`themes.${u}`,u),[t]);return e.jsx(ge,{...s,type:"themes",labelKey:"gamesListToolbar.filter.themes",searchPlaceholderKey:"gamesListToolbar.filter.searchThemes",valueExtractor:u=>u.themes,formatValue:l})}function Nt(s){return e.jsx(ge,{...s,type:"keywords",labelKey:"gamesListToolbar.filter.keywords",searchPlaceholderKey:"gamesListToolbar.filter.searchKeywords",valueExtractor:t=>t.keywords})}function Tt(s){return e.jsx(ge,{...s,type:"platforms",labelKey:"gamesListToolbar.filter.platforms",searchPlaceholderKey:"gamesListToolbar.filter.searchPlatforms",valueExtractor:t=>t.platforms})}function $t(s){const{t}=te(),l=a.useMemo(()=>u=>t(`gameModes.${u}`,u),[t]);return e.jsx(ge,{...s,type:"gameModes",labelKey:"gamesListToolbar.filter.gameModes",searchPlaceholderKey:"gamesListToolbar.filter.searchGameModes",valueExtractor:u=>u.gameModes,formatValue:l})}function It(s){return e.jsx(ge,{...s,type:"publishers",labelKey:"gamesListToolbar.filter.publishers",searchPlaceholderKey:"gamesListToolbar.filter.searchPublishers",valueExtractor:t=>t.publishers})}function Mt(s){return e.jsx(ge,{...s,type:"developers",labelKey:"gamesListToolbar.filter.developers",searchPlaceholderKey:"gamesListToolbar.filter.searchDevelopers",valueExtractor:t=>t.developers})}function At(s){const{t}=te(),l=a.useMemo(()=>u=>t(`playerPerspectives.${u}`,u),[t]);return e.jsx(ge,{...s,type:"playerPerspectives",labelKey:"gamesListToolbar.filter.playerPerspectives",searchPlaceholderKey:"gamesListToolbar.filter.searchPlayerPerspectives",valueExtractor:u=>u.playerPerspectives,formatValue:l})}function Dt(s){return e.jsx(ge,{...s,type:"gameEngines",labelKey:"gamesListToolbar.filter.gameEngines",searchPlaceholderKey:"gamesListToolbar.filter.searchGameEngines",valueExtractor:t=>t.gameEngines})}const Pt={type:"decade",labelKey:"gamesListToolbar.filter.decade",searchPlaceholderKey:"gamesListToolbar.filter.searchDecade",getAvailableValues:s=>{const t=new Set;return s.forEach(l=>{if(l.year!==null&&l.year!==void 0){const u=Math.floor(l.year/10)*10;t.add(u)}}),Array.from(t).sort((l,u)=>u-l).map(l=>({value:l,label:`${l}s`}))},formatValue:s=>typeof s=="number"?`${s}s`:"",isScrollable:!1};function Bt(s){return e.jsx(xe,{...s,config:Pt})}function zt({availableCollections:s=[],...t}){const l=a.useMemo(()=>({type:"collection",labelKey:"gamesListToolbar.filter.collection",searchPlaceholderKey:"gamesListToolbar.filter.searchCollection",getAvailableValues:(c,g)=>(g?.availableCollections||s).map(v=>({value:v.id,label:v.title})),formatValue:c=>{if(c==null)return"";const g=s.find(p=>String(p.id)===String(c));return g?g.title:""},isScrollable:!0}),[s]),u=a.useMemo(()=>({availableCollections:s}),[s]);return e.jsx(xe,{...t,config:l,additionalData:u})}function Gt({games:s=[],...t}){const{t:l,i18n:u}=te(),c={type:"ageRating",labelKey:"gamesListToolbar.filter.ageRating",searchPlaceholderKey:"gamesListToolbar.filter.searchAgeRating",getAvailableValues:g=>{const p=new Map;return g.forEach(v=>{v.ageRatings&&v.ageRatings.length>0&&Ce(v.ageRatings,u.language).forEach(d=>{const n=`${d.category}-${d.rating}`;p.has(n)||p.set(n,{category:d.category,rating:d.rating})})}),Array.from(p.values()).map(v=>{const m=Ee(v.category,v.rating,l);return{value:`${v.category}-${v.rating}`,label:m}}).sort((v,m)=>{const[d,n]=v.value.split("-").map(Number),[S,L]=m.value.split("-").map(Number);return d!==S?d-S:n-L})},formatValue:g=>{if(typeof g=="string"&&g.includes("-")){const[p,v]=g.split("-").map(Number);return Ee(p,v,l)}return""},isScrollable:!0};return e.jsx(xe,{...t,config:c,games:s})}function ee({type:s,isOpen:t,onClose:l,onCloseCompletely:u,selectedValue:c,onSelect:g,games:p=[],availableGenres:v=[],availableCollections:m=[]}){const d={isOpen:t,onClose:l,onCloseCompletely:u,selectedValue:c,onSelect:g,games:p};switch(s){case"year":return e.jsx(Et,{...d});case"genre":return e.jsx(Rt,{...d,availableGenres:v});case"themes":return e.jsx(kt,{...d});case"keywords":return e.jsx(Nt,{...d});case"platforms":return e.jsx(Tt,{...d});case"gameModes":return e.jsx($t,{...d});case"publishers":return e.jsx(It,{...d});case"developers":return e.jsx(Mt,{...d});case"playerPerspectives":return e.jsx(At,{...d});case"gameEngines":return e.jsx(Dt,{...d});case"decade":return e.jsx(Bt,{...d});case"collection":return e.jsx(zt,{...d,availableCollections:m});case"ageRating":return e.jsx(Gt,{...d});default:return null}}function Kt({isOpen:s,onClose:t,currentFilter:l,selectedYear:u,selectedGenre:c,selectedThemes:g,selectedKeywords:p,selectedPlatforms:v,selectedGameModes:m,selectedPublishers:d,selectedDevelopers:n,selectedPlayerPerspectives:S,selectedGameEngines:L,selectedDecade:j,selectedCollection:I,selectedAgeRating:M,onFilterChange:i,onYearFilterChange:f,onGenreFilterChange:h,onThemesFilterChange:y,onKeywordsFilterChange:N,onPlatformsFilterChange:E,onGameModesFilterChange:R,onPublishersFilterChange:$,onDevelopersFilterChange:H,onPlayerPerspectivesFilterChange:k,onGameEnginesFilterChange:D,onDecadeFilterChange:P,onCollectionFilterChange:V,onAgeRatingFilterChange:z,games:G=[],availableGenres:Y=[],availableCollections:ce=[]}){const{t:O}=te(),[K,b]=a.useState(null),ne=a.useRef(null),r=a.useRef(null),_=a.useRef(!1),W=a.useRef(!0);a.useEffect(()=>{s&&(W.current?(b(null),W.current=!1,l==="year"?r.current="year":l==="genre"?r.current="genre":l==="themes"?r.current="themes":l==="keywords"?r.current="keywords":l==="platforms"?r.current="platforms":l==="gameModes"?r.current="gameModes":l==="publishers"?r.current="publishers":l==="developers"?r.current="developers":l==="playerPerspectives"?r.current="playerPerspectives":l==="gameEngines"?r.current="gameEngines":l==="decade"?r.current="decade":l==="collection"?r.current="collection":l==="ageRating"?r.current="ageRating":r.current=null,_.current=!1):_.current?(b(null),l==="year"?r.current="year":l==="genre"?r.current="genre":l==="themes"?r.current="themes":l==="keywords"?r.current="keywords":l==="platforms"?r.current="platforms":l==="gameModes"?r.current="gameModes":l==="publishers"?r.current="publishers":l==="developers"?r.current="developers":l==="playerPerspectives"?r.current="playerPerspectives":l==="gameEngines"?r.current="gameEngines":l==="decade"?r.current="decade":l==="collection"?r.current="collection":l==="ageRating"&&(r.current="ageRating")):l==="year"?(b("year"),r.current="year"):l==="genre"?(b("genre"),r.current="genre"):l==="themes"?(b("themes"),r.current="themes"):l==="keywords"?(b("keywords"),r.current="keywords"):l==="platforms"?(b("platforms"),r.current="platforms"):l==="gameModes"?(b("gameModes"),r.current="gameModes"):l==="publishers"?(b("publishers"),r.current="publishers"):l==="developers"?(b("developers"),r.current="developers"):l==="playerPerspectives"?(b("playerPerspectives"),r.current="playerPerspectives"):l==="gameEngines"?(b("gameEngines"),r.current="gameEngines"):l==="decade"?(b("decade"),r.current="decade"):l==="collection"?(b("collection"),r.current="collection"):l==="ageRating"?(b("ageRating"),r.current="ageRating"):r.current?b(r.current):b(null))},[s,l]),a.useEffect(()=>{if(!s&&!K)return;function o(T){const be=T.target;let ye=!1;s&&ne.current&&(ye=!ne.current.contains(be)),ye&&!K&&t()}return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[s,K,t]),a.useEffect(()=>{if(!s&&!K)return;function o(T){T.key==="Escape"&&(K?(b(null),_.current=!0):t())}return document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o)}},[s,K,t]);const U=o=>{o==="year"?(b("year"),r.current="year",_.current=!1):o==="genre"?(b("genre"),r.current="genre",_.current=!1):o==="themes"?(b("themes"),r.current="themes",_.current=!1):o==="keywords"?(b("keywords"),r.current="keywords",_.current=!1):o==="platforms"?(b("platforms"),r.current="platforms",_.current=!1):o==="gameModes"?(b("gameModes"),r.current="gameModes",_.current=!1):o==="publishers"?(b("publishers"),r.current="publishers",_.current=!1):o==="developers"?(b("developers"),r.current="developers",_.current=!1):o==="playerPerspectives"?(b("playerPerspectives"),r.current="playerPerspectives",_.current=!1):o==="gameEngines"?(b("gameEngines"),r.current="gameEngines",_.current=!1):o==="decade"?(b("decade"),r.current="decade",_.current=!1):o==="collection"?(b("collection"),r.current="collection",_.current=!1):o==="ageRating"?(b("ageRating"),r.current="ageRating",_.current=!1):(i?.(o),f&&f(null),h&&h(null),y&&y(null),N&&N(null),E&&E(null),R&&R(null),$&&$(null),H&&H(null),k&&k(null),D&&D(null),P&&P(null),V&&V(null),z&&z(null),b(null),r.current=null,t())},C=o=>{const T=typeof o=="number"?o:null;T===null?(i?.("all"),f?.(null),b(null),r.current=null,t()):(i?.("year"),f?.(T),r.current="year",t())},q=o=>{o!=="year"&&f?.(null),o!=="genre"&&h?.(null),o!=="themes"&&y?.(null),o!=="keywords"&&N?.(null),o!=="platforms"&&E?.(null),o!=="gameModes"&&R?.(null),o!=="publishers"&&$?.(null),o!=="developers"&&H?.(null),o!=="playerPerspectives"&&k?.(null),o!=="gameEngines"&&D?.(null),o!=="decade"&&P?.(null),o!=="collection"&&V?.(null),o!=="ageRating"&&z?.(null)},oe=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),h?.(null),b(null),r.current=null,t()):(i?.("genre"),h?.(T),q("genre"),r.current="genre",t())},se=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),y?.(null),b(null),r.current=null,t()):(i?.("themes"),y?.(T),q("themes"),r.current="themes",t())},ue=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),N?.(null),b(null),r.current=null,t()):(i?.("keywords"),N?.(T),q("keywords"),r.current="keywords",t())},le=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),E?.(null),b(null),r.current=null,t()):(i?.("platforms"),E?.(T),q("platforms"),r.current="platforms",t())},re=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),R?.(null),b(null),r.current=null,t()):(i?.("gameModes"),R?.(T),q("gameModes"),r.current="gameModes",t())},J=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),$?.(null),b(null),r.current=null,t()):(i?.("publishers"),$?.(T),q("publishers"),r.current="publishers",t())},Z=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),H?.(null),b(null),r.current=null,t()):(i?.("developers"),H?.(T),q("developers"),r.current="developers",t())},F=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),k?.(null),b(null),r.current=null,t()):(i?.("playerPerspectives"),k?.(T),q("playerPerspectives"),r.current="playerPerspectives",t())},me=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),D?.(null),b(null),r.current=null,t()):(i?.("gameEngines"),D?.(T),q("gameEngines"),r.current="gameEngines",t())},ie=o=>{const T=typeof o=="number"?o:null;T===null?(i?.("all"),P?.(null),b(null),r.current=null,t()):(i?.("decade"),P?.(T),q("decade"),r.current="decade",t())},pe=o=>{if(o===null)i?.("all"),V?.(null),b(null),r.current=null,t();else{const T=typeof o=="string"?o:String(o);i?.("collection"),V?.(T),q("collection"),r.current="collection",t()}},ae=o=>{const T=typeof o=="string"?o:null;T===null?(i?.("all"),z?.(null),b(null),r.current=null,t()):(i?.("ageRating"),z?.(T),q("ageRating"),r.current="ageRating",t())},Q=()=>{b(null),r.current=null,_.current=!0},X=()=>{b(null),t()};return s&&K==="year"?e.jsx(ee,{type:"year",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:u,onSelect:C,games:G}):s&&K==="genre"?e.jsx(ee,{type:"genre",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:c,onSelect:oe,games:G,availableGenres:Y}):s&&K==="themes"?e.jsx(ee,{type:"themes",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:g,onSelect:se,games:G}):s&&K==="keywords"?e.jsx(ee,{type:"keywords",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:p,onSelect:ue,games:G}):s&&K==="platforms"?e.jsx(ee,{type:"platforms",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:v,onSelect:le,games:G}):s&&K==="gameModes"?e.jsx(ee,{type:"gameModes",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:m,onSelect:re,games:G}):s&&K==="publishers"?e.jsx(ee,{type:"publishers",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:d,onSelect:J,games:G}):s&&K==="developers"?e.jsx(ee,{type:"developers",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:n,onSelect:Z,games:G}):s&&K==="playerPerspectives"?e.jsx(ee,{type:"playerPerspectives",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:S,onSelect:F,games:G}):s&&K==="gameEngines"?e.jsx(ee,{type:"gameEngines",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:L,onSelect:me,games:G}):s&&K==="decade"?e.jsx(ee,{type:"decade",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:j,onSelect:ie,games:G}):s&&K==="collection"?e.jsx(ee,{type:"collection",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:I,onSelect:pe,games:G,availableCollections:ce}):s&&K==="ageRating"?e.jsx(ee,{type:"ageRating",isOpen:!0,onClose:Q,onCloseCompletely:X,selectedValue:M,onSelect:ae,games:G}):!s||K?null:e.jsxs("div",{className:"filter-popup",ref:ne,children:[e.jsxs("button",{className:`filter-popup-item ${l==="all"?"selected":""}`,onClick:()=>U("all"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.all")}),l==="all"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsx("div",{className:"filter-popup-divider"}),e.jsxs("button",{className:`filter-popup-item ${l==="genre"?"selected":""}`,onClick:()=>U("genre"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.genre")}),l==="genre"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="themes"?"selected":""}`,onClick:()=>U("themes"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.themes")}),l==="themes"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="keywords"?"selected":""}`,onClick:()=>U("keywords"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.keywords")}),l==="keywords"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="platforms"?"selected":""}`,onClick:()=>U("platforms"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.platforms")}),l==="platforms"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="gameModes"?"selected":""}`,onClick:()=>U("gameModes"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.gameModes")}),l==="gameModes"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="publishers"?"selected":""}`,onClick:()=>U("publishers"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.publishers")}),l==="publishers"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="developers"?"selected":""}`,onClick:()=>U("developers"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.developers")}),l==="developers"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="playerPerspectives"?"selected":""}`,onClick:()=>U("playerPerspectives"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.playerPerspectives")}),l==="playerPerspectives"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="gameEngines"?"selected":""}`,onClick:()=>U("gameEngines"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.gameEngines")}),l==="gameEngines"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="year"?"selected":""}`,onClick:()=>U("year"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.year")}),l==="year"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="decade"?"selected":""}`,onClick:()=>U("decade"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.decade")}),l==="decade"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="ageRating"?"selected":""}`,onClick:()=>U("ageRating"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.ageRating")}),l==="ageRating"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]}),e.jsxs("button",{className:`filter-popup-item ${l==="collection"?"selected":""}`,onClick:()=>U("collection"),children:[e.jsx("span",{children:O("gamesListToolbar.filter.collection")}),l==="collection"&&e.jsx("svg",{className:"filter-popup-check",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z",fill:"#E5A00D"})})]})]})}function Ht({isOpen:s,onClose:t,currentSort:l,sortAscending:u,onSortChange:c,onSortDirectionChange:g}){const{t:p}=te(),v=a.useRef(null);a.useEffect(()=>{if(!s)return;function n(S){v.current&&!v.current.contains(S.target)&&t()}return document.addEventListener("mousedown",n),()=>{document.removeEventListener("mousedown",n)}},[s,t]),a.useEffect(()=>{if(!s)return;function n(S){S.key==="Escape"&&t()}return document.addEventListener("keydown",n),()=>{document.removeEventListener("keydown",n)}},[s,t]);const m=[{value:"title",label:p("gamesListToolbar.sort.title")},{value:"year",label:p("gamesListToolbar.sort.year")},{value:"releaseDate",label:p("gamesListToolbar.sort.releaseDate")},{value:"criticRating",label:p("gamesListToolbar.sort.criticRating")},{value:"userRating",label:p("gamesListToolbar.sort.userRating")},{value:"stars",label:p("gamesListToolbar.sort.stars")},{value:"ageRating",label:p("gamesListToolbar.sort.ageRating")}],d=n=>{n===l&&g?g(!u):(c?.(n),g&&g(!0)),t()};return s?e.jsx("div",{className:"sort-popup",ref:v,children:m.map(n=>e.jsxs("button",{className:`sort-popup-item ${l===n.value?"selected":""}`,onClick:()=>d(n.value),children:[e.jsx("span",{children:n.label}),l===n.value&&e.jsx("svg",{className:`sort-popup-sort-direction ${u?"ascending":"descending"}`,width:"10",height:"10",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:u?"M6 2L10 8H2L6 2Z":"M6 10L2 4H10L6 10Z",fill:"currentColor"})})]},n.value))}):null}function Ot({gamesCount:s,games:t=[],onFilterChange:l,onYearFilterChange:u,onGenreFilterChange:c,onThemesFilterChange:g,onKeywordsFilterChange:p,onPlatformsFilterChange:v,onGameModesFilterChange:m,onPublishersFilterChange:d,onDevelopersFilterChange:n,onPlayerPerspectivesFilterChange:S,onGameEnginesFilterChange:L,onDecadeFilterChange:j,onCollectionFilterChange:I,onAgeRatingFilterChange:M,onSortChange:i,onSortDirectionChange:f,currentFilter:h="all",selectedYear:y=null,selectedGenre:N=null,selectedThemes:E=null,selectedKeywords:R=null,selectedPlatforms:$=null,selectedGameModes:H=null,selectedPublishers:k=null,selectedDevelopers:D=null,selectedPlayerPerspectives:P=null,selectedGameEngines:V=null,selectedDecade:z=null,selectedCollection:G=null,selectedAgeRating:Y=null,currentSort:ce="title",sortAscending:O=!0,viewMode:K="grid",availableGenres:b=[],availableCollections:ne=[]}){const{t:r}=te(),[_,W]=a.useState(!1),[U,C]=a.useState(!1),q=a.useRef(null),oe=a.useRef(null),ue=(()=>{if(h==="year"&&y!==null)return y.toString();if(h==="decade"&&z!==null)return`${z}s`;if(h==="collection"&&G!==null){const Z=ne?.find(F=>String(F.id)===String(G));return Z?Z.title:String(G)}if(h==="genre"&&N!==null){const Z=b.find(F=>F.title===N);return Z?r(`genre.${Z.title}`,Z.title):N}if(h==="themes"&&E!==null)return r(`themes.${E}`,E);if(h==="keywords"&&R!==null)return R;if(h==="platforms"&&$!==null)return $;if(h==="gameModes"&&H!==null)return r(`gameModes.${H}`,H);if(h==="publishers"&&k!==null)return k;if(h==="developers"&&D!==null)return D;if(h==="playerPerspectives"&&P!==null)return r(`playerPerspectives.${P}`,P);if(h==="gameEngines"&&V!==null)return V;if(h==="ageRating"&&Y!==null){const[Z,F]=Y.split("-").map(Number);return Ee(Z,F,r)||Y}return[{value:"all",label:r("gamesListToolbar.filter.all")},{value:"genre",label:r("gamesListToolbar.filter.genre")},{value:"themes",label:r("gamesListToolbar.filter.themes")},{value:"keywords",label:r("gamesListToolbar.filter.keywords")},{value:"platforms",label:r("gamesListToolbar.filter.platforms")},{value:"gameModes",label:r("gamesListToolbar.filter.gameModes")},{value:"publishers",label:r("gamesListToolbar.filter.publishers")},{value:"developers",label:r("gamesListToolbar.filter.developers")},{value:"playerPerspectives",label:r("gamesListToolbar.filter.playerPerspectives")},{value:"gameEngines",label:r("gamesListToolbar.filter.gameEngines")},{value:"year",label:r("gamesListToolbar.filter.year")},{value:"decade",label:r("gamesListToolbar.filter.decade")},{value:"collection",label:r("gamesListToolbar.filter.collection")},{value:"ageRating",label:r("gamesListToolbar.filter.ageRating")}].find(Z=>Z.value===h)?.label||""})(),re=[{value:"title",label:r("gamesListToolbar.sort.title")},{value:"year",label:r("gamesListToolbar.sort.year")},{value:"releaseDate",label:r("gamesListToolbar.sort.releaseDate")},{value:"criticRating",label:r("gamesListToolbar.sort.criticRating")},{value:"userRating",label:r("gamesListToolbar.sort.userRating")},{value:"stars",label:r("gamesListToolbar.sort.stars")},{value:"ageRating",label:r("gamesListToolbar.sort.ageRating")}].find(J=>J.value===ce)?.label||"";return e.jsx("div",{className:"games-list-toolbar",children:e.jsxs("div",{className:"games-list-toolbar-left",children:[e.jsxs("div",{className:"games-list-toolbar-item",ref:q,children:[e.jsxs("button",{className:"games-list-toolbar-button",onClick:()=>{W(!_),C(!1)},children:[h&&h!=="all"&&e.jsx("span",{className:"games-list-toolbar-clear-button",onClick:J=>{J.stopPropagation(),l?.("all"),u&&u(null),c&&c(null),g&&g(null),p&&p(null),v&&v(null),m&&m(null),d&&d(null),n&&n(null),S&&S(null),L&&L(null),j&&j(null),I&&I(null),M&&M(null),W(!1)},role:"button",tabIndex:0,onKeyDown:J=>{(J.key==="Enter"||J.key===" ")&&(J.preventDefault(),J.stopPropagation(),l?.("all"),u&&u(null),c&&c(null),g&&g(null),p&&p(null),v&&v(null),m&&m(null),d&&d(null),n&&n(null),S&&S(null),L&&L(null),j&&j(null),I&&I(null),M&&M(null),W(!1))},children:e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsx("span",{className:"games-list-toolbar-value",children:ue}),e.jsx("svg",{className:`games-list-toolbar-arrow ${_?"open":""}`,width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M6 9L1 4h10L6 9z",fill:"currentColor"})})]}),e.jsx(Kt,{isOpen:_,onClose:()=>W(!1),currentFilter:h,selectedYear:y,selectedGenre:N,selectedThemes:E,selectedKeywords:R,selectedPlatforms:$,selectedGameModes:H,selectedPublishers:k,selectedDevelopers:D,selectedPlayerPerspectives:P,selectedGameEngines:V,selectedDecade:z,selectedCollection:G,selectedAgeRating:Y,onFilterChange:l,onYearFilterChange:u,onGenreFilterChange:c,onThemesFilterChange:g,onKeywordsFilterChange:p,onPlatformsFilterChange:v,onGameModesFilterChange:m,onPublishersFilterChange:d,onDevelopersFilterChange:n,onPlayerPerspectivesFilterChange:S,onGameEnginesFilterChange:L,onDecadeFilterChange:j,onCollectionFilterChange:I,onAgeRatingFilterChange:M,games:t,availableGenres:b,availableCollections:ne})]}),K!=="table"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"games-list-toolbar-item",ref:oe,children:[e.jsxs("button",{className:"games-list-toolbar-button",onClick:()=>{C(!U),W(!1)},children:[e.jsxs("span",{className:"games-list-toolbar-value",children:[r("gamesListToolbar.sort.prefix")," ",re]}),e.jsx("svg",{className:`games-list-toolbar-arrow ${U?"open":""}`,width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M6 9L1 4h10L6 9z",fill:"currentColor"})})]}),e.jsx(Ht,{isOpen:U,onClose:()=>C(!1),currentSort:ce,sortAscending:O,onSortChange:i,onSortDirectionChange:f})]}),e.jsx("span",{className:"games-list-toolbar-count",children:s})]}),K==="table"&&e.jsx("span",{className:"games-list-toolbar-count",children:s})]})})}function _t({hook:s,viewMode:t,coverSize:l,isLoading:u,isReady:c,allCollections:g=[],onGameClick:p,onGamesLoaded:v,onPlay:m,buildCoverUrlFn:d}){const{games:n,filterField:S,setFilterField:L,selectedYear:j,setSelectedYear:I,selectedDecade:M,setSelectedDecade:i,selectedCollection:f,setSelectedCollection:h,selectedAgeRating:y,setSelectedAgeRating:N,selectedGenre:E,setSelectedGenre:R,selectedThemes:$,setSelectedThemes:H,selectedKeywords:k,setSelectedKeywords:D,selectedPlatforms:P,setSelectedPlatforms:V,selectedGameModes:z,setSelectedGameModes:G,selectedPublishers:Y,setSelectedPublishers:ce,selectedDevelopers:O,setSelectedDevelopers:K,selectedPlayerPerspectives:b,setSelectedPlayerPerspectives:ne,selectedGameEngines:r,setSelectedGameEngines:_,sortField:W,setSortField:U,sortAscending:C,setSortAscending:q,columnVisibility:oe,toggleColumn:se,handleTableSort:ue,filteredAndSortedGames:le,scrollContainerRef:re,tableScrollRef:J,itemRefs:Z,handleGameUpdate:F,handleGameDelete:me,availableGenres:ie,availableCollections:pe}=s;a.useEffect(()=>{n.length>0&&v(n)},[n.length]);const ae=d||_e;return e.jsxs("div",{className:`home-page-content-wrapper ${!u&&n.length>0?"has-toolbar":""}`,style:{opacity:c?1:0,transition:"opacity 0.2s ease-in-out"},children:[!u&&n.length>0&&e.jsx(Ot,{gamesCount:le.length,games:n,onFilterChange:L,onYearFilterChange:I,onGenreFilterChange:R,onThemesFilterChange:H,onKeywordsFilterChange:D,onPlatformsFilterChange:V,onGameModesFilterChange:G,onPublishersFilterChange:ce,onDevelopersFilterChange:K,onPlayerPerspectivesFilterChange:ne,onGameEnginesFilterChange:_,onDecadeFilterChange:i,onSortChange:U,onSortDirectionChange:q,currentFilter:S,selectedYear:j,selectedGenre:E,selectedDecade:M,selectedCollection:f,onCollectionFilterChange:h,selectedAgeRating:y,onAgeRatingFilterChange:N,selectedThemes:$,selectedKeywords:k,selectedPlatforms:P,selectedGameModes:z,selectedPublishers:Y,selectedDevelopers:O,selectedPlayerPerspectives:b,selectedGameEngines:r,currentSort:W,sortAscending:C,viewMode:t,availableGenres:ie,availableCollections:pe}),t==="table"&&!u&&n.length>0&&e.jsx(wt,{columnVisibility:oe,onToggleColumn:se,sortField:W,sortAscending:C,onSort:ue}),e.jsx("div",{ref:re,className:`home-page-scroll-container ${t==="table"?"table-view":""} ${!u&&le.length===0?"centered-content min-h-[400px]":""}`,children:!u&&e.jsxs(e.Fragment,{children:[t==="grid"&&e.jsx(nt,{games:le,onGameClick:p,onPlay:m,onGameUpdate:F,onGameDelete:me,buildCoverUrl:ae,coverSize:l,itemRefs:Z,viewMode:t,allCollections:g,scrollContainerRef:re}),t==="detail"&&e.jsx(pt,{games:le,onGameClick:p,onPlay:m,onGameUpdate:F,onGameDelete:me,buildCoverUrl:ae,itemRefs:Z,allCollections:g,scrollContainerRef:re}),t==="table"&&e.jsx(jt,{games:le,onGameClick:p,onPlay:m,onGameUpdate:F,onGameDelete:me,itemRefs:Z,scrollContainerRef:J,allCollections:g,columnVisibility:oe})]})})]})}function rs({onGameClick:s,onGamesLoaded:t,onPlay:l,coverSize:u,viewMode:c,allCollections:g=[]}){const{isLoading:p,setLoading:v}=it(),{isLoading:m}=Ue(),d=ct({localStoragePrefix:"library",defaultFilterField:"all",waitForAuth:!0,listenToMetadataReload:!0,gameEvents:["gameUpdated"],scrollRestorationMode:c==="table"?void 0:c});a.useEffect(()=>{v(m||!d.isReady)},[m,d.isReady,v]);const n=a.useCallback(S=>{t(S)},[t]);return e.jsx("main",{className:"flex-1 home-page-content",children:e.jsxs("div",{className:"home-page-layout",children:[e.jsx(_t,{hook:d,viewMode:c,coverSize:u,isLoading:p,isReady:d.isReady,allCollections:g,onGameClick:s,onGamesLoaded:n,onPlay:l,buildCoverUrlFn:_e}),d.sortField==="title"&&d.isReady&&e.jsx(ot,{games:d.filteredAndSortedGames,scrollContainerRef:c==="table"?d.tableScrollRef:d.scrollContainerRef,itemRefs:d.itemRefs,ascending:d.sortAscending,virtualizedGridRef:c==="grid"&&d.scrollContainerRef.current?d.scrollContainerRef.current.__virtualizedGridRef:void 0,virtualizedListRef:c==="detail"&&d.scrollContainerRef.current?d.scrollContainerRef.current.__virtualizedListRef:void 0,viewMode:c,coverSize:u})]})})}export{_t as G,rs as L,ct as u};
