import{r as n,j as e}from"./react-vendor-jNdKP8wU.js";import{u as G,e as H}from"./page-CollectionsPage.tsx-DjVo-48O.js";import{A as I}from"./page-AddGamePage.tsx-CGFUTWrs.js";import{a as U,n as j}from"./page-HomePage.tsx-DvziKYYh.js";/* empty css                              */import{u as K}from"./i18n-vendor-mPXi0JFR.js";function te(){const{t,i18n:u}=K(),{setLoading:w,isLoading:Y}=G(),[a,b]=n.useState("en"),[L,m]=n.useState(null),[T,y]=n.useState(!1),[r,v]=n.useState([...U]),[S,p]=n.useState(null),[o,A]=n.useState(""),[g,_]=n.useState(""),[E,O]=n.useState(null),[F,R]=n.useState(null),[V,D]=n.useState(!1),$=S!==null&&(r.length!==S.length||r.some((s,l)=>s!==S[l])),J=L!==null&&a!==L||$,P=E!==null&&o!==E||F!==null&&g!==F;n.useEffect(()=>{const s=localStorage.getItem("twitch_client_id")||"",l=localStorage.getItem("twitch_client_secret")||"";A(s),_(l),O(s),R(l);const i=()=>{const x=localStorage.getItem("visibleLibraries");if(!x)return null;try{return JSON.parse(x)}catch{return null}};async function N(){w(!0);const x=new AbortController,z=setTimeout(()=>x.abort(),9e4);try{const f=new URL("/settings",I),d=await fetch(f.toString(),{headers:H({Accept:"application/json"}),signal:x.signal});if(clearTimeout(z),d.ok){const c=await d.json(),h=c.language||"en";b(h),m(h),u.changeLanguage(h);const C=j(c.visibleLibraries);v(C),p(C),localStorage.setItem("visibleLibraries",JSON.stringify(C))}else{const c=localStorage.getItem("language")||"en";b(c),m(c),u.changeLanguage(c);const h=j(i());v(h),p(h)}}catch(f){clearTimeout(z),console.error("Failed to load settings:",f);const d=localStorage.getItem("language")||"en";b(d),m(d),u.changeLanguage(d);const c=j(i());v(c),p(c)}finally{w(!1)}}N()},[w]);async function k(){y(!0);const s=new AbortController,l=setTimeout(()=>s.abort(),9e4);try{const i=new URL("/settings",I),N=await fetch(i.toString(),{method:"PUT",headers:H({"Content-Type":"application/json"}),body:JSON.stringify({language:a,visibleLibraries:r}),signal:s.signal});if(clearTimeout(l),!N.ok)throw new Error("Failed to save settings");localStorage.setItem("language",a),localStorage.setItem("visibleLibraries",JSON.stringify(r)),u.changeLanguage(a),m(a),p(r)}catch(i){clearTimeout(l),console.error("Failed to save settings:",i),localStorage.setItem("language",a),localStorage.setItem("visibleLibraries",JSON.stringify(r)),u.changeLanguage(a),m(a),p(r)}finally{y(!1)}}const B=s=>{v(l=>{const i=new Set(l);return i.has(s)?i.delete(s):i.add(s),j(Array.from(i))})};function q(){if(!(!o.trim()||!g.trim())){D(!0);try{localStorage.setItem("twitch_client_id",o.trim()),localStorage.setItem("twitch_client_secret",g.trim()),O(o.trim()),R(g.trim());const s=I.replace(/\/$/,"");window.location.href=s}catch(s){console.error("Failed to save Twitch credentials:",s),D(!1)}}}return e.jsx("div",{className:"bg-[#1a1a1a] text-white settings-page",children:e.jsxs("div",{className:"settings-container",children:[e.jsxs("div",{className:"settings-header",children:[e.jsx("h1",{className:"settings-title",children:t("settings.title")}),e.jsx("p",{className:"settings-subtitle",children:t("settings.subtitle")})]}),e.jsxs("div",{className:"bg-[#1a1a1a] settings-card",children:[e.jsx("div",{className:"settings-card-header",children:e.jsx("h2",{className:"settings-card-title",children:t("settings.general")})}),e.jsxs("div",{className:"settings-card-content",children:[e.jsx("div",{className:"settings-field-small",children:e.jsxs("div",{className:"settings-label",children:[t("settings.version")," ","0.1.7"]})}),e.jsxs("div",{className:"settings-field",children:[e.jsxs("div",{className:"settings-field-row",children:[e.jsx("label",{className:"settings-label",htmlFor:"language-select",children:t("settings.language")}),e.jsxs("select",{id:"language-select",name:"language",value:a,onChange:s=>b(s.target.value),className:"settings-select",children:[e.jsx("option",{value:"en",children:t("settings.english")}),e.jsx("option",{value:"it",children:t("settings.italian")}),e.jsx("option",{value:"pt",children:t("settings.portuguese")}),e.jsx("option",{value:"es",children:t("settings.spanish")}),e.jsx("option",{value:"fr",children:t("settings.french")}),e.jsx("option",{value:"de",children:t("settings.german")}),e.jsx("option",{value:"zh",children:t("settings.chinese")}),e.jsx("option",{value:"ja",children:t("settings.japanese")})]})]}),e.jsx("p",{className:"settings-help-text",children:t("settings.selectLanguage")})]}),e.jsxs("div",{className:"settings-field",children:[e.jsx("div",{className:"settings-label",children:t("settings.pages")}),e.jsx("div",{className:"settings-library-options",children:U.map(s=>e.jsxs("label",{className:"settings-library-option",children:[e.jsx("input",{type:"checkbox",checked:r.includes(s),onChange:()=>B(s),className:"settings-checkbox"}),e.jsx("span",{children:t(`libraries.${s}`)})]},s))}),e.jsx("p",{className:"settings-help-text",children:t("settings.pagesHelp")})]}),e.jsx("div",{className:"settings-actions",children:e.jsx("button",{onClick:k,className:`settings-button ${J?"settings-button-active":""}`,disabled:Y||T||!J,children:t(T?"settings.saving":"settings.save")})})]})]}),e.jsxs("div",{className:"bg-[#1a1a1a] settings-card",style:{marginTop:"24px"},children:[e.jsx("div",{className:"settings-card-header",children:e.jsx("h2",{className:"settings-card-title",children:t("settings.twitch.title","Twitch OAuth")})}),e.jsxs("div",{className:"settings-card-content",children:[e.jsx("p",{className:"settings-help-text",style:{marginBottom:"24px"},children:t("settings.twitch.description","Configure your Twitch OAuth application credentials. You can get these from the Twitch Developer Console.")}),e.jsxs("div",{className:"settings-field",children:[e.jsx("label",{className:"settings-label",htmlFor:"twitch-client-id",children:t("settings.twitch.clientId","Client ID")}),e.jsx("input",{id:"twitch-client-id",type:"text",value:o,onChange:s=>A(s.target.value),className:"settings-input",placeholder:t("settings.twitch.clientIdPlaceholder","Enter your Twitch Client ID"),style:{marginTop:"8px"}}),e.jsx("p",{className:"settings-help-text",children:t("settings.twitch.clientIdHelp","Your Twitch application Client ID")})]}),e.jsxs("div",{className:"settings-field",children:[e.jsx("label",{className:"settings-label",htmlFor:"twitch-client-secret",children:t("settings.twitch.clientSecret","Client Secret")}),e.jsx("input",{id:"twitch-client-secret",type:"password",value:g,onChange:s=>_(s.target.value),className:"settings-input",placeholder:t("settings.twitch.clientSecretPlaceholder","Enter your Twitch Client Secret"),style:{marginTop:"8px"}}),e.jsx("p",{className:"settings-help-text",children:t("settings.twitch.clientSecretHelp","Your Twitch application Client Secret (keep this secure)")})]}),e.jsx("div",{className:"settings-actions",children:e.jsx("button",{onClick:q,className:`settings-button ${P?"settings-button-active":""}`,disabled:!o.trim()||!g.trim()||V||!P,children:t(V?"settings.saving":"settings.save")})})]})]})]})})}export{te as S};
