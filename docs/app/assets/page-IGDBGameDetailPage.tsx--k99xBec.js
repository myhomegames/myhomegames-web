import{r as p,j as t,u as A,b as H,d as W}from"./react-vendor-jNdKP8wU.js";import{g as D,h as R,e as B,i as U,a as O,j as X,u as _,k as V,l as Y,T as P}from"./page-CollectionsPage.tsx-DjVo-48O.js";import{u as T}from"./i18n-vendor-mPXi0JFR.js";import{g as I,A as G,a as K,c as Z,f as q}from"./page-AddGamePage.tsx-CGFUTWrs.js";import{B as J,u as Q,L as ee}from"./page-HomePage.tsx-DvziKYYh.js";/* empty css                                    */const $=p.createContext(void 0);function ke({children:e}){const[i,r]=p.useState([]),[c,h]=p.useState(!1),[m,o]=p.useState(null),{isLoading:b,token:v}=D(),x=p.useCallback(async()=>{if(b||!(I()||v))return;h(!0),o(null);const a=new AbortController,l=setTimeout(()=>a.abort(),9e4);try{const g=R(G,"/categories"),w=await fetch(g,{headers:B({Accept:"application/json"}),signal:a.signal});if(clearTimeout(l),!w.ok)throw new Error(`HTTP ${w.status}`);const f=((await w.json()).categories||[]).map(k=>({id:k.id,title:k.title,cover:k.cover}));r(f)}catch(g){clearTimeout(l);const w=String(g.message||g);console.error("Error fetching categories:",w),o(w)}finally{h(!1)}},[b,v]);p.useEffect(()=>{if(b)return;const n=setTimeout(x,0);return()=>clearTimeout(n)},[b,x]),p.useEffect(()=>{const n=g=>{const C=g.detail?.category;C&&r(S=>S.map(f=>String(f.id)===String(C.id)?C:f))},a=()=>{x()},l=()=>{x()};return window.addEventListener("categoryUpdated",n),window.addEventListener("metadataReloaded",a),window.addEventListener("gameAdded",l),()=>{window.removeEventListener("categoryUpdated",n),window.removeEventListener("metadataReloaded",a),window.removeEventListener("gameAdded",l)}},[x]);const y=p.useCallback(async()=>{await x()},[x]),s=p.useCallback(n=>{r(a=>{if(a.some(g=>String(g.id)===String(n.id)))return a;const l=[...a,n];return l.sort((g,w)=>g.title.localeCompare(w.title)),l})},[]),u=p.useCallback(n=>{r(a=>a.map(l=>String(l.id)===String(n.id)?n:l))},[]),d=p.useCallback(n=>{r(a=>a.filter(l=>String(l.id)!==String(n)))},[]),j=p.useMemo(()=>({categories:i,isLoading:c,error:m,refreshCategories:y,addCategory:s,updateCategory:u,removeCategory:d}),[i,c,m,y,s,u,d]);return t.jsx($.Provider,{value:j,children:e})}function te(){const e=p.useContext($);if(e===void 0)throw new Error("useCategories must be used within a CategoriesProvider");return e}const ne=()=>({themes:new Map,platforms:new Map,gameModes:new Map,playerPerspectives:new Map,gameEngines:new Map,franchises:new Map,series:new Map}),F=p.createContext(void 0),se=[["themes","/themes","themes"],["platforms","/platforms","platforms"],["gameModes","/game-modes","gameModes"],["playerPerspectives","/player-perspectives","playerPerspectives"],["gameEngines","/game-engines","gameEngines"],["franchises","/franchises","franchises"],["series","/series","series"]];function Se({children:e}){const[i,r]=p.useState(ne),{isLoading:c,token:h}=D(),m=p.useCallback(async()=>{if(c||!(I()||h))return;const v=B({Accept:"application/json"}),x=await Promise.all(se.map(async([y,s,u])=>{const d=await fetch(R(G,s),{headers:v});if(!d.ok)return{key:y,map:new Map};const n=(await d.json())[u]||[],a=new Map;for(const l of n){const g=String(l.id);a.set(g,l.title??l.name??g)}return{key:y,map:a}}));r(y=>{const s={...y};for(const{key:u,map:d}of x)s[u]=d;return s})},[c,h]);p.useEffect(()=>{c||!I()&&!h||m()},[c,h,m]),p.useEffect(()=>{const b=()=>m();return window.addEventListener("gameAdded",b),()=>window.removeEventListener("gameAdded",b)},[m]);const o={tagLabels:i,refreshTagLists:m};return t.jsx(F.Provider,{value:o,children:e})}function ie(){const e=p.useContext(F);if(e===void 0)throw new Error("useTagLists must be used within TagListsProvider");return e}function re({summary:e,truncateOnly:i=!1,maxLines:r=4,fontSize:c}){const{t:h}=T(),[m,o]=p.useState(!1),[b,v]=p.useState(!1),x=p.useRef(null);return p.useEffect(()=>{if(x.current&&!i){const s=parseFloat(getComputedStyle(x.current).lineHeight)*r;x.current.scrollHeight>s&&v(!0)}},[e,i,r]),e?t.jsxs("div",{style:{marginTop:"16px"},children:[t.jsx("div",{ref:x,className:"text-white",style:{opacity:.8,fontFamily:"var(--font-body-1-font-family)",fontSize:c||"var(--font-body-1-font-size)",lineHeight:"var(--font-body-1-line-height)",display:"-webkit-box",WebkitLineClamp:m?"none":r,WebkitBoxOrient:"vertical",overflow:m?"visible":"hidden",textOverflow:m?"clip":"ellipsis"},children:e}),b&&!i&&t.jsxs("button",{onClick:()=>o(!m),style:{backgroundColor:"transparent",border:"none",color:"#E5A00D",cursor:"pointer",padding:0,marginTop:"8px",fontFamily:"var(--font-body-1-font-family)",fontSize:"var(--font-body-1-font-size)",lineHeight:"var(--font-body-1-line-height)",display:"flex",alignItems:"center",gap:"4px"},children:[t.jsx("span",{children:h(m?"common.less":"common.more")}),t.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{transform:m?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"},children:t.jsx("path",{d:"M7 10l5 5 5-5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]})]}):null}function E({items:e,getLabel:i,onItemClick:r,isClickable:c,getKey:h,showMoreMinCount:m=4,showMoreLabel:o,useInfoStyles:b=!1}){const{t:v}=T(),[x,y]=p.useState(!1);if(!e||e.length===0)return null;const s=l=>{l.stopPropagation(),y(!0)},u=(m??0)>0&&e.length>(m??0),d=!!o&&u&&!x,j=d?e.slice(0,m):e,n=(l,g)=>h?h(l,g):`${i(l)}-${g}`,a=b?{className:"game-info-list"}:{style:{display:"flex",flexWrap:"wrap",gap:"8px",alignItems:"baseline"}};return t.jsxs("div",{...a,children:[j.map((l,g)=>{const w=i(l),C=!!r&&(c?c(l):!0),S=b?C?t.jsx("button",{type:"button",className:"game-info-list-item game-info-list-link",onClick:()=>r?.(l),children:w}):t.jsx("span",{className:"game-info-list-item",children:w}):t.jsx("span",{onClick:C?()=>r?.(l):void 0,style:{color:"rgba(255, 255, 255, 0.8)",fontFamily:"var(--font-body-2-font-family)",fontSize:"var(--font-body-2-font-size)",lineHeight:"var(--font-body-2-line-height)",cursor:C?"pointer":"default",textDecoration:"none"},onMouseEnter:f=>{C&&(f.currentTarget.style.textDecoration="underline",f.currentTarget.style.color="rgba(255, 255, 255, 1)")},onMouseLeave:f=>{C&&(f.currentTarget.style.textDecoration="none",f.currentTarget.style.color="rgba(255, 255, 255, 0.8)")},children:w});return t.jsxs("span",{children:[S,g<j.length-1&&(b?t.jsxs("span",{className:"game-info-list-separator",children:[","," "]}):t.jsxs("span",{style:{color:"rgba(255, 255, 255, 0.8)",fontFamily:"var(--font-body-2-font-family)",fontSize:"var(--font-body-2-font-size)",lineHeight:"var(--font-body-2-line-height)"},children:[","," "]})),g===j.length-1&&d&&(b?t.jsxs("span",{className:"game-info-list-separator",children:[","," "]}):t.jsxs("span",{style:{color:"rgba(255, 255, 255, 0.8)",fontFamily:"var(--font-body-2-font-family)",fontSize:"var(--font-body-2-font-size)",lineHeight:"var(--font-body-2-line-height)"},children:[","," "]}))]},n(l,g))}),d&&(b?t.jsx("span",{className:"game-info-list-item",children:t.jsx("button",{type:"button",className:"game-info-list-item game-info-list-link",onClick:s,style:{display:"inline-flex",alignItems:"center",lineHeight:"var(--font-body-2-line-height)",verticalAlign:"baseline"},children:o??v("gameDetail.andMore",", and more")})}):t.jsx("span",{onClick:s,style:{color:"rgba(255, 255, 255, 0.8)",fontFamily:"var(--font-body-2-font-family)",fontSize:"var(--font-body-2-font-size)",lineHeight:"var(--font-body-2-line-height)",cursor:"pointer",textDecoration:"none",display:"inline-flex",alignItems:"center",verticalAlign:"baseline"},onMouseEnter:l=>{l.currentTarget.style.textDecoration="underline",l.currentTarget.style.color="rgba(255, 255, 255, 1)"},onMouseLeave:l=>{l.currentTarget.style.textDecoration="none",l.currentTarget.style.color="rgba(255, 255, 255, 0.8)"},children:o??v("gameDetail.andMore",", and more")}))]})}const L={"steampowered.com":"Steam","store.steampowered.com":"Steam","epicgames.com":"Epic Games","www.epicgames.com":"Epic Games","gog.com":"GOG","www.gog.com":"GOG","itch.io":"itch.io","xbox.com":"Xbox","playstation.com":"PlayStation","nintendo.com":"Nintendo","twitch.tv":"Twitch","youtube.com":"YouTube","twitter.com":"Twitter","facebook.com":"Facebook","instagram.com":"Instagram","reddit.com":"Reddit","discord.com":"Discord","github.com":"GitHub","wikia.com":"Fandom","fandom.com":"Fandom"};function ae(e){try{let r=new URL(e).hostname;if(L[r])return L[r];const c=r.replace(/^www\./,"");if(L[c])return L[c];const h=c.split(".");if(h.length>=2){const m=h[h.length-2];return m.charAt(0).toUpperCase()+m.slice(1)}return c}catch{const r=e.match(/https?:\/\/(?:www\.)?([^\/]+)/);if(r&&r[1]){const c=r[1];if(L[c])return L[c];const h=c.split(".")[0];return h.charAt(0).toUpperCase()+h.slice(1)}return e.length>30?e.substring(0,27)+"...":e}}function oe(e){try{const i=new URL(e).hostname;return i?`https://www.google.com/s2/favicons?domain=${i}&sz=32`:null}catch{return null}}function le({url:e}){const i=ae(e),r=oe(e);return t.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"websites-list-item",title:i,children:r&&t.jsx("img",{src:r,alt:"","aria-hidden":"true",className:"websites-list-favicon",loading:"lazy"})})}function ce({websites:e}){return!e||e.length===0?null:t.jsx("div",{className:"websites-list",children:e.map((i,r)=>t.jsxs("span",{children:[t.jsx(le,{url:i.url,category:i.category}),r<e.length-1&&t.jsx("span",{className:"game-info-list-separator",children:" "})]},r))})}function N(e){return e==null||!Array.isArray(e)?[]:e.map(i=>typeof i=="object"&&i!=null&&"id"in i?String(i.id):String(i))}function de({game:e}){const{t:i}=T(),r=A(),{games:c}=U(),{developers:h}=O(),{publishers:m}=X(),{tagLabels:o}=ie(),b="id"in e?String(e.id):void 0,v=N(e.franchise),x=N(e.series??e.collection);if(!(b!==void 0||e.themes&&e.themes.length>0||e.platforms&&e.platforms.length>0||e.gameModes&&e.gameModes.length>0||e.playerPerspectives&&e.playerPerspectives.length>0||e.websites&&e.websites.length>0||e.developers&&e.developers.length>0||e.publishers&&e.publishers.length>0||v.length>0||x.length>0||e.screenshots&&e.screenshots.length>0||e.gameEngines&&e.gameEngines.length>0||e.alternativeNames&&e.alternativeNames.length>0||e.similarGames&&e.similarGames.length>0))return null;const s=(n,a,l)=>t.jsx(E,{items:n,getLabel:l,onItemClick:g=>r(`${a}/${encodeURIComponent(g)}`),useInfoStyles:!0,showMoreMinCount:5,showMoreLabel:i("gameDetail.andMore",", and more")}),u=p.useMemo(()=>{const n=new Map;for(const a of c)n.set(String(a.id),a);return n},[c]),d=p.useMemo(()=>{const n=new Map;if(e.developers&&Array.isArray(e.developers))for(const a of e.developers){const l=typeof a=="object"&&a!=null&&"id"in a?String(a.id):String(a),g=typeof a=="object"&&a!=null&&"name"in a?a.name:null;l&&g&&n.set(l,g)}return n},[e.developers]),j=p.useMemo(()=>{const n=new Map;if(e.publishers&&Array.isArray(e.publishers))for(const a of e.publishers){const l=typeof a=="object"&&a!=null&&"id"in a?String(a.id):String(a),g=typeof a=="object"&&a!=null&&"name"in a?a.name:null;l&&g&&n.set(l,g)}return n},[e.publishers]);return t.jsxs("div",{className:"game-info-block",children:[e.themes&&e.themes.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.themes","Themes")}),s(N(e.themes),"/themes",n=>i(`themes.${o.themes.get(n)??n}`,o.themes.get(n)??n))]}),e.platforms&&e.platforms.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.platforms","Platforms")}),s(N(e.platforms),"/platforms",n=>o.platforms.get(n)??n)]}),e.gameModes&&e.gameModes.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.gameModes","Game Modes")}),s(N(e.gameModes),"/game-modes",n=>i(`gameModes.${o.gameModes.get(n)??n}`,o.gameModes.get(n)??n))]}),e.playerPerspectives&&e.playerPerspectives.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.playerPerspectives","Player Perspectives")}),s(N(e.playerPerspectives),"/player-perspectives",n=>i(`playerPerspectives.${o.playerPerspectives.get(n)??n}`,o.playerPerspectives.get(n)??n))]}),e.websites&&e.websites.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.websites","Websites")}),t.jsx(ce,{websites:e.websites})]}),e.developers&&e.developers.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.developers","Developers")}),t.jsx(E,{items:N(e.developers),getLabel:n=>d.get(n)??h.find(a=>String(a.id)===n)?.title??n,onItemClick:n=>r(`/developers/${encodeURIComponent(n)}`),useInfoStyles:!0,showMoreMinCount:5,showMoreLabel:i("gameDetail.andMore",", and more")})]}),e.publishers&&e.publishers.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.publishers","Publishers")}),t.jsx(E,{items:N(e.publishers),getLabel:n=>j.get(n)??m.find(a=>String(a.id)===n)?.title??n,onItemClick:n=>r(`/publishers/${encodeURIComponent(n)}`),useInfoStyles:!0,showMoreMinCount:5,showMoreLabel:i("gameDetail.andMore",", and more")})]}),v.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.franchise","Franchise")}),s(v,"/franchise",n=>o.franchises.get(n)??n)]}),x.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.series","Series")}),s(x,"/series",n=>o.series.get(n)??n)]}),e.gameEngines&&e.gameEngines.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.gameEngines","Game Engines")}),s(N(e.gameEngines),"/game-engines",n=>o.gameEngines.get(n)??n)]}),e.alternativeNames&&e.alternativeNames.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.alternativeNames","Alternative Names")}),t.jsx(E,{items:e.alternativeNames,getLabel:n=>n,useInfoStyles:!0,showMoreMinCount:5,showMoreLabel:i("gameDetail.andMore",", and more")})]}),e.similarGames&&e.similarGames.length>0&&t.jsxs("div",{className:"game-info-field",children:[t.jsx("div",{className:"text-white game-info-label",children:i("igdbInfo.similarGames","Similar Games")}),t.jsx(E,{items:e.similarGames,getLabel:n=>n.name,getKey:n=>String(n.id),onItemClick:n=>r(`/game/${n.id}`),isClickable:n=>u.has(String(n.id)),useInfoStyles:!0,showMoreMinCount:5,showMoreLabel:i("gameDetail.andMore",", and more")})]})]})}function ge({screenshots:e,videos:i}){const[r,c]=p.useState(null),h=p.useRef(null),m=e?.length||0,o=[...(e||[]).map((s,u)=>({type:"screenshot",src:s,index:u})),...(i||[]).map((s,u)=>({type:"video",src:s,index:m+u}))];if(o.length===0)return null;const b=s=>{c(s)},v=()=>{c(null)},x=p.useCallback(s=>{if(r!==null)if(s==="prev"){const u=r>0?r-1:o.length-1;c(u)}else{const u=r<o.length-1?r+1:0;c(u)}},[r,o]);p.useEffect(()=>{if(r===null)return;const s=u=>{u.key==="Escape"?v():u.key==="ArrowLeft"?x("prev"):u.key==="ArrowRight"&&x("next")};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[r,x]),p.useEffect(()=>{const s=h.current;if(!s)return;const u=d=>{const j=s.getBoundingClientRect();if(!(d.clientX>=j.left&&d.clientX<=j.right&&d.clientY>=j.top&&d.clientY<=j.bottom)||!(s.scrollWidth>s.clientWidth))return;if(Math.abs(d.deltaX)>Math.abs(d.deltaY)||Math.abs(d.deltaX)>0){d.preventDefault(),d.stopPropagation();const g=s.scrollLeft,w=s.scrollWidth-s.clientWidth,C=g>0&&d.deltaX<0,S=g<w&&d.deltaX>0;(C||S)&&(s.scrollLeft+=d.deltaX)}};return s.addEventListener("wheel",u,{passive:!1,capture:!0}),()=>{s.removeEventListener("wheel",u)}},[]);const y=r!==null?o[r]:null;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{ref:h,style:{display:"flex",flexDirection:"row",gap:"12px",overflowX:"auto",overflowY:"hidden",paddingBottom:"8px",scrollbarWidth:"thin",scrollbarColor:"rgba(255, 255, 255, 0.3) transparent"},children:[i&&i.map((s,u)=>t.jsx("div",{onClick:()=>b(m+u),style:{flexShrink:0,width:"300px",borderRadius:"4px",cursor:"pointer",aspectRatio:"16/9",transition:"opacity 0.2s ease, transform 0.2s ease",position:"relative",overflow:"hidden"},onMouseEnter:d=>{d.currentTarget.style.opacity="0.8",d.currentTarget.style.transform="scale(1.02)"},onMouseLeave:d=>{d.currentTarget.style.opacity="1",d.currentTarget.style.transform="scale(1)"},children:t.jsx("iframe",{src:s,title:`Video ${u+1}`,style:{width:"100%",height:"100%",border:"none",borderRadius:"4px"},allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; compute-pressure",allowFullScreen:!0})},`video-${u}`)),e&&e.map((s,u)=>t.jsx("img",{src:s,alt:`Screenshot ${u+1}`,onClick:()=>b(u),style:{flexShrink:0,width:"300px",height:"auto",borderRadius:"4px",cursor:"pointer",objectFit:"cover",aspectRatio:"16/9",transition:"opacity 0.2s ease, transform 0.2s ease"},onMouseEnter:d=>{d.currentTarget.style.opacity="0.8",d.currentTarget.style.transform="scale(1.02)"},onMouseLeave:d=>{d.currentTarget.style.opacity="1",d.currentTarget.style.transform="scale(1)"}},`screenshot-${u}`))]}),r!==null&&y&&H.createPortal(t.jsx("div",{onClick:v,style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.9)",zIndex:10010,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},children:t.jsxs("div",{onClick:s=>s.stopPropagation(),style:{position:"relative",maxWidth:"90vw",maxHeight:"90vh",display:"flex",alignItems:"center",justifyContent:"center"},children:[o.length>1&&t.jsx("button",{onClick:s=>{s.stopPropagation(),x("prev")},style:{position:"absolute",left:"-60px",backgroundColor:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"50%",width:"48px",height:"48px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",transition:"background-color 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.3)"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)"},children:"‹"}),y.type==="screenshot"?t.jsx("img",{src:y.src,alt:`Screenshot ${r+1}`,style:{maxWidth:"100%",maxHeight:"90vh",borderRadius:"4px",objectFit:"contain"}}):t.jsx("iframe",{src:y.src,title:`Video ${r+1}`,style:{width:"90vw",maxWidth:"1600px",aspectRatio:"16/9",borderRadius:"4px",border:"none"},allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; compute-pressure",allowFullScreen:!0}),o.length>1&&t.jsx("button",{onClick:s=>{s.stopPropagation(),x("next")},style:{position:"absolute",right:"-60px",backgroundColor:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"50%",width:"48px",height:"48px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",transition:"background-color 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.3)"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)"},children:"›"}),t.jsx("button",{onClick:v,style:{position:"absolute",top:"-60px",right:"0",backgroundColor:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:"50%",width:"48px",height:"48px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"24px",transition:"background-color 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.3)"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.2)"},children:"×"}),o.length>1&&t.jsxs("div",{style:{position:"absolute",bottom:"-40px",left:"50%",transform:"translateX(-50%)",color:"white",fontFamily:"var(--font-body-2-font-family)",fontSize:"var(--font-body-2-font-size)",opacity:.8},children:[r+1," / ",o.length]})]})}),document.body)]})}const ue={en:1,it:2,es:2,fr:2,pt:2,de:4,ja:3,zh:1},he={1:"ESRB",2:"PEGI",3:"CERO",4:"USK",5:"GRAC",6:"CLASS_IND",7:"ACB"},me={1:{6:"EC",7:"E",8:"E10",9:"T",10:"M",11:"AO",12:"RP"},2:{1:"Three",2:"Seven",3:"Twelve",4:"Sixteen",5:"Eighteen"},3:{1:"A",2:"B",3:"C",4:"D",5:"Z"},4:{1:"Zero",2:"Six",3:"Twelve",4:"Sixteen",5:"Eighteen"},5:{1:"ALL",2:"Twelve",3:"Fifteen",4:"Eighteen"},6:{1:"L",2:"Ten",3:"Twelve",4:"Fourteen",5:"Sixteen",6:"Eighteen"},7:{1:"G",2:"PG",3:"M",4:"MA15",5:"R18"}};function z(e,i){const r=i.split("-")[0],c=ue[r]||1;return e.filter(h=>h&&h.category!==void 0&&h.category!==null&&h.rating!==void 0&&h.rating!==null&&h.category===c)}function fe(e,i,r){if(e==null||i===void 0||i===null)return"";const c=he[e];if(!c)return`Category ${e} Rating ${i}`;const m=me[e]?.[i];if(!m)return`${c} ${i}`;const o=`igdbInfo.ageRating.${c}.${m}`,b=r(o);return b!==o?b:`${c} ${m}`}function pe({ageRatings:e}){const{t:i,i18n:r}=T();if(!e||e.length===0)return null;const c=z(e,r.language);return c.length===0?null:t.jsx("div",{className:"age-ratings-list",children:c.map((h,m,o)=>{const b=fe(h.category,h.rating,i);return b?t.jsxs("span",{children:[t.jsx("span",{className:"age-rating-item",children:b}),m<o.length-1&&t.jsxs("span",{className:"age-rating-separator",children:[","," "]})]},m):null})})}function Ne(){const{t:e,i18n:i}=T(),{igdbId:r}=W(),c=A(),{isLoading:h,setLoading:m}=_(),[o,b]=p.useState(null),v=V({onGameAdded:g=>{g?.id?c(`/game/${g.id}`):c("/")},onError:g=>{alert(e("igdbGameDetail.errorAdding")+": "+g)}}),x=p.useCallback(async g=>{m(!0);try{const w=R(G,`/igdb/game/${g}`),C={Accept:"application/json","X-Auth-Token":I()},S=K(),f=Z();S&&(C["X-Twitch-Client-Id"]=S),f&&(C["X-Twitch-Client-Secret"]=f);const k=await fetch(w,{headers:C});if(!k.ok){if(k.status===404){b(null);return}throw new Error(`HTTP ${k.status}`)}const M=await k.json();if(!M){b(null);return}b(M)}catch(w){const C=String(w.message||w);console.error("Error fetching IGDB game:",C),b(null)}finally{m(!1)}},[m]);p.useEffect(()=>{r&&x(parseInt(r,10))},[r,x]);async function y(){o&&await v.addGame(o)}if(h)return null;if(!o)return t.jsx("div",{className:"bg-[#1a1a1a] text-white flex items-center justify-center igdb-game-detail-not-found",children:t.jsx("div",{className:"text-center",children:t.jsx("div",{className:"text-gray-400",children:e("igdbGameDetail.notFound")})})});const s=256,u=384,d=o.cover||"",j=!!(o?.background&&o.background.trim()!==""),n=o?.background||"",a=(()=>{const g=localStorage.getItem("coverSize");return g?parseInt(g,10):150})(),l=g=>{localStorage.setItem("coverSize",g.toString())};return t.jsx(J,{backgroundUrl:n,hasBackground:j,elementId:`igdb-${o.id}`,children:t.jsx(be,{game:o,coverUrl:d,coverWidth:s,coverHeight:u,coverSize:a,handleCoverSizeChange:l,markingAsOwned:v.isAdding,onMarkAsOwned:y,t:e,i18n:i})})}function be({game:e,coverUrl:i,coverWidth:r,coverHeight:c,coverSize:h,handleCoverSizeChange:m,markingAsOwned:o,onMarkAsOwned:b,t:v,i18n:x}){const y=f=>q(f,v,x),s=f=>{if(f==null||isNaN(f))return null;const k=Number(f);if(k>=0&&k<=100){const M=k/10;return M%1===0?M.toString():M.toFixed(1)}return null},u=e&&e.genres&&Array.isArray(e.genres)&&e.genres.length>0?e.genres.filter(f=>f&&typeof f=="string"&&f.trim()).map(f=>f.trim()):null,d=s(e.criticRating),j=s(e.userRating),{hasBackground:n,isBackgroundVisible:a}=Q(),l=A(),{categories:g}=te(),w=f=>{const k=g.find(M=>M.title===f);k&&l(`/category/${k.id}`)},S=(()=>{let f=1;return y(e)&&f++,u&&u.length>0&&f++,(d!==null||j!==null)&&f++,f++,Math.max(2,Math.min(6,7-f))})();return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:`igdb-game-detail-libraries-bar-wrapper ${n&&a?"game-detail-libraries-bar-transparent":""}`,children:t.jsx(ee,{libraries:[],activeLibrary:{key:"game",type:"game"},onSelectLibrary:()=>{},loading:!1,error:null,coverSize:h,onCoverSizeChange:m,viewMode:"grid",onViewModeChange:()=>{},hideBackgroundToggle:!0})}),t.jsx("div",{className:"igdb-game-detail-container",children:t.jsx("div",{className:"home-page-main-container igdb-game-detail-main-container",children:t.jsx("main",{className:"flex-1 home-page-content igdb-game-detail-content",children:t.jsx("div",{className:"home-page-layout igdb-game-detail-layout",children:t.jsx("div",{className:"home-page-content-wrapper igdb-game-detail-content-wrapper",children:t.jsxs("div",{className:"home-page-scroll-container igdb-game-detail-scroll-container",children:[t.jsxs("div",{className:"pt-8 igdb-game-detail-header",children:[t.jsx("div",{className:"igdb-game-detail-cover-wrapper",children:t.jsx(Y,{title:e.name,coverUrl:i,width:r,height:c,showTitle:!1,titlePosition:"overlay",detail:!1,play:!1,showBorder:!1})}),t.jsx("div",{className:"igdb-game-detail-info-panel",style:{minHeight:`${c}px`},children:t.jsxs("div",{className:"igdb-game-detail-info-content",children:[t.jsx("h1",{className:"text-white igdb-game-detail-title",children:e.name}),y(e)&&(()=>{const k=(e.ageRatings&&e.ageRatings.length>0?z(e.ageRatings,x.language):[]).length>0;return t.jsxs("div",{className:"text-white igdb-game-detail-release-date",children:[y(e),k&&t.jsxs("span",{className:"igdb-game-detail-age-ratings-inline",children:["•   ",t.jsx(pe,{ageRatings:e.ageRatings||[]})]})]})})(),u&&u.length>0&&t.jsx(E,{items:u,getLabel:f=>v(`genre.${f}`,f),onItemClick:w,showMoreLabel:v("gameDetail.andMore",", and more")}),d!==null||j!==null?t.jsxs("div",{className:"igdb-game-detail-ratings",children:[d!==null&&t.jsx(P,{text:v("gameDetail.criticRating"),children:t.jsxs("div",{className:"text-white igdb-game-detail-rating-item",children:[t.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"#FFD700",stroke:"#FFA500",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"igdb-game-detail-rating-icon",children:t.jsx("path",{d:"M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"})}),d]})}),j!==null&&t.jsx(P,{text:v("gameDetail.userRating"),children:t.jsxs("div",{className:"text-white igdb-game-detail-rating-item",children:[t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"#4CAF50",stroke:"#2E7D32",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"igdb-game-detail-rating-icon",children:[t.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"9",cy:"7",r:"4"}),t.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),t.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),j]})})]}):null,t.jsx("div",{className:"game-detail-actions",children:t.jsxs("button",{onClick:b,disabled:o,className:"igdb-game-detail-mark-owned-button",children:[t.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"currentColor",className:"igdb-game-detail-mark-owned-button-icon",children:t.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),v(o?"igdbGameDetail.adding":"igdbGameDetail.add")]})}),e.summary&&t.jsx(re,{summary:e.summary,maxLines:S})]})})]}),(e.screenshots&&e.screenshots.length>0||e.videos&&e.videos.length>0)&&t.jsx("div",{className:"igdb-game-detail-media-section",children:t.jsx(ge,{screenshots:e.screenshots,videos:e.videos})}),t.jsx("div",{className:"igdb-game-detail-info-section",children:t.jsx(de,{game:e})})]})})})})})})]})}export{pe as A,ke as C,de as G,E as I,ge as M,re as S,Se as T,ie as a,z as b,Ne as c,fe as f,te as u};
